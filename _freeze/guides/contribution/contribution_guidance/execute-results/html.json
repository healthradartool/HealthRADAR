{
  "hash": "73eab59ad683fc1f73c7fdcb10bb4f9d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Health RADAR Contribution Guide\"\nsubtitle: \"This guide provides detailed instructions to help you effectively contribute pages to the Health RADAR project.\"\npage-layout: full\nformat: \n  html: \n    code-fold: false\ntitle-block-banner: \"#EDF3F9\"\ntitle-block-banner-color: \"#212529\"\ncomments: false\n---\n\n\n\n\n## How to contribute a page\nContributing a page requires the completion of a page template, with a folder for static images and any sample datasets used. All code chunks will be contained within the page text in a qmd format. If you are not familiar with the qmd format, follow the template provided with a pre-populated example.\n\n\n## Instructions to complete template\nPlease read this manual before populating the template for your RADAR page. \nThe Master template is available in `Health RADAR Workbench / Templates`. Do not edit the template. Please save a copy to your organisation folder and label it with the page title. \n\n\n#### Notes about the template style\nThis is a file written in markdown. Markdown is a simple markup language for formatting text quickly and easily, commonly used for creating clean and readable documents and will help us to turn your page into a website.\n\n##### Rules: \n\n- Maintain the # signs.  These help to separate Titles and Headings.  A single # is for the main title and additional # signs are for subheadings. \n\n- We have provided standardised headings for you to use (highlighted). Please feel free to add additional headings and subheadings as you see fit. The Highlighted fields are for you to populate. \n- Please write the text in a readable format with our target users being analysts, researchers and public health officials working in malaria.\n\n\n##### Including static images.\n\n- Create a folder for each page\n- Save each image you wish to include on the page\n- On the template, you can note the image file name and desired caption as in the example below.   \nE.g. (images/filename.png \"caption\")\n\n##### Including links:\n\nYou can mix the links in with your text in the following way:\n\n\\[Link Description](actual link goes here)\n\nExample:\n\\[Data Visualisation Tips and Tricks](https://r4ds.had.co.nz/data-visualisation.html)\n\n#### Section specific information\n\n#### Page header text\n\nCategories: \n\nChoose these search terms to describe your page  (max 6)\n\nExisting terms:\n\n- Global, regional, country-level, urban, rural\n- Annual, monthly, daily, hourly\n- Epidemiology, climate, intervention,  demography, entomology\n\nNew terms: add…\n\n#### Description\n\nKeep it short and to the point. What is the type of data (annual, monthly etc)? How often is it updated? If there are multiple datasets then provide a short description for each one. Also mention where historical data can be found if necessary and some caveats (if known) with the datasets. Think about the lifespan of any links that you include\n\n\n#### How to use the data?\n\n\nIf you are comfortable coding up the access to the data, then place the code chunk in the template here. Provide a brief summary of the dataset once it is read in (first ~50 lines). If you are not comfortable with code, then leave this section blank.\n\n\n#### How to plot this data?\n\nOnce again, if you are comfortable coding up a few interesting plots to visualise the data, then please include that here. Take a look at the plotting templates in the resources to get an idea of plotting styles. If you cannot do the coding section, then please ignore that section and provide an explanation of a plot that would benefit the end used. An example description could be:\n\n“Line plots of the annual reported malaria cases for country A, B, C and D for the period 2000 - 2022” \n\n#### Key points to consider:\n\nThese are short, dataset specific bullet points that bring attention to certain features of the data that an end user might overlook. These could be the fact that the dataset contains annual data which means that trends within years would not be captured (all data points generated at the end of year, for example), or when it would be suitable to use this dataset and when another dataset would be preferable\n\n### Visualisation Guidance\n\nIn general, the visualisations should highlight the type of data available from a data source. Try to keep to roughly 4 key visualisations that allow visitors to quickly engage with the dataset while learning. They should be as beginner-friendly as possible so that the visualisation and plotting code can ideally both be understood relatively quickly.\n\nIn terms of styling, please apply the `theme_health_radar()`, `scale_colour_manual_health_radar()`, `scale_fill_manual_health_radar()`, `scale_colour_continuous_health_radar()` and `scale_fill_continuous_health_radar()` whenever possible. This will ensure consistency in the visualisations across the entire website. \n\nTo understand the process a bit better, let's go through an example from the [World Malaria Report](https://jfunction.quarto.pub/healthradar/datasources/malaria/who-wmr/who_wmr.html)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the elimination 8 countries\ne8_countries <- c(\"Botswana\", \"Eswatini\", \"Namibia\", \"South Africa\", \"Angola\", \"Mozambique\", \"Zambia\", \"Zimbabwe\")\n\n# Load the map data for Africa\ne8_africa <- ne_countries(continent = \"Africa\", returnclass = \"sf\") |>\n  mutate(name = if_else(name==\"eSwatini\", \"Eswatini\", name)) |>\n  filter(name %in% e8_countries)\n\n# Merge the map data with your data\ne8_data <- e8_africa %>%\n  left_join(wmr2023$wmr2023j |> mutate(), by = c(\"name\" = \"Country/area\"))\n\n# Create the choropleth map\nggplot(data = e8_data) +\n  geom_sf(aes(fill = `2022`), color = \"lightgrey\", size = 0.3) +  # Use fill for the continuous 2022 data\n  theme_health_radar() +\n  scale_fill_continuous_health_radar(name = \"Deaths\") +  # Correct fill scale for continuous data\n  labs(title = \"Reported malaria deaths in the Elimination 8 countries (2022)\",\n       caption = \"A choropleth map of the reported malaria deaths in the Elimination 8 countries in 2022. The map highlights the variation in reported malaria mortality across the E8 countries, with higher mortality rates in Angola, Mozambique, and Zambia. It is important to note that these are reported malaria deaths and may not capture the full extent of malaria mortality in these countries due to underreporting and misclassification of deaths. It would therefore also be useful to consider estimated malaria deaths as well. Source: WMR 2023 Annex 4J\",\n       x = \"Latitude\",\n       y = \"Longitude\") +\n  \n  geom_sf_text(aes(label = name, color = ifelse(`2022` > mean(`2022`), \"black\", \"white\")), size = 3) +  # Conditional text color\n  scale_color_identity()  # Keep scale_color_identity() to use specified colors directly\n```\n:::\n\n\n\n\n\nThe code above has a few key elements. Firstly, notice how the pre-processing steps have been added to give the reader a clearer idea of the necessary transformations required to prepare the dataset for visualisations. You should also add comments to this part to help guide the reader. Secondly is the actual plot, which is created using `ggplot2`. Notice how the theme and continuous fill colours have been applied. Also see that the caption is quite descriptive and that the source has been added at the end. This allows the visualisation to stand on its own if it is copied as-is and reduces the chances of misinterpretation and misuse. It is highly recommended that you follow this blueprint.\n\nLet's also take a look at a plot that uses a discrete colour palette:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the plot for Deaths with low and high bands\nwhowmr::wmr2023$wmr2023f |>\n  # Filter for the E8 countries\n  filter(`Country/area` |> stringr::str_detect(\"Angola|Botswana|Eswatini|Malawi|Mozambique|Namibia|South Africa|Zambia|Zimbabwe\")) |>\n  # Rename columns to something more readable\n  rename(Country=\"Country/area\", `Population at risk`=\"Population denominator for incidence and mortality rate\") |>\n  # Hide the footnotes\n  mutate(Country=Country |> stringr::str_remove(\"\\\\d.*$\")) |> \n  # Remove the WHO Region column\n  select(!`WHO Region`) |> \n  ggplot(aes(x = Year, y = Cases_Point, group = Country, color = Country)) +\n    geom_line(linewidth = 1) +\n    geom_ribbon(aes(ymin = Cases_Lower, ymax = Cases_Upper, fill = Country), alpha = 0.2) +  # Corrected to use 'fill' for the ribbon\n    scale_colour_manual_health_radar() +  # Apply manual color scale for 'color' aesthetic (lines)\n    scale_fill_manual_health_radar() +    # Apply manual color scale for 'fill' aesthetic (ribbon fill)\n    theme_health_radar() +\n    labs(\n      title = \"Estimated Malaria Cases (2000-2022)\",\n      subtitle = \"With confidence bands\",\n      x = \"Year\",\n      y = \"Number of Cases (thousands)\",\n      color = \"Country\",\n      fill = \"Country\",  # Added 'fill' label for the ribbon shading\n      caption = \"A plot of the estimated malaria cases in selected countries from 2000 to 2022. The lines represent the estimated number of cases, while the shaded areas represent the confidence bands around the estimates. Notice the variation in malaria cases across countries and over time, with some countries experiencing fluctuations in case numbers. It is important to consider the uncertainty around these estimates when interpreting the data. For example, looking at the plot for Mozambique, the total number of cases did not change much over the years, with the confidence bands staying relatively stable, whereas Angola saw fluctuations in the number of cases, with much wider confidence bands from 2015, indicating greater uncertainty in the estimates. Source: WMR 2023 Annex 4F\")\n```\n:::\n\n\n\n\n\nThis plot is very similar in terms of general structure to the previous one, but uses the discrete `scale_colour_manual_health_radar()` and `scale_fill_manual_health_radar()` colour palettes for the countries to ensure consistency. There are 20 colours in this palette, which should be more than enough for most visualisations.\n\n### Modelling example Guidance\n\n### Code Guidance\n\nGet started by forking/cloning the repository from https://github.com/uct-masha/HealthRADAR and opening it as a project in RStudio – we use `renv` to manage the package versions and have decided that `(as at Aug 2024) R 4.4.0` is the version we should support for development. This is the version that the automated builder will use then automatically publishing the tool to https://jfunction.quarto.pub/healthradar/ \n\nIf you intend running any code in the project and have not yet read the documentation for `renv`, you simply must go do so before proceeding. It won't take you too long and working through it is going to save you a lot of time and frustration. The pages are located in their own directory under `datasources/malaria/`\n\nSometimes there's a need to make a little dataset which will be used in examples on the page. In this case, some way of getting that dataset should be described. We thought it best to describe this in some document which is stored in the Health RADAR repository under, eg, `scripts/access.R.` This could be a script which downloads some large dataset and preprocesses it into something small enough to use in examples. This way, we don't have to pollute the main page with details on exactly how the specific instance of data was accessed but we maintain traceability into such details should the user want to explore this further. This may make more sense in cases such as using [STATcompiler](https://www.statcompiler.com/en) to download DHS survey data since there's a web page you need to work with to actually get a dataset which we still want to make visualisations about (and modelling examples). In this case one could store a short walk through on the steps required to reconstruct the sample dataset used in visualisations on the site.\n\nWhere it is sensible to do so, contributions should focus on the malaria in the E8 countries. Preferably they should focus on the four front-line countries (perhaps rotate through these countries in different examples to give an even spread)\n\nExamples should not copy/reproduce already existing derivatives of the data but rather demonstrate something interesting and new.\n\nWhen including `R code` in the project:\n\n- Use `theme_health_radar()` where possible, it's from `theme_health_radar.R`\n\nWhen adding visualisations or modelling examples:\n\n- Describe in the text what the visualisation is telling us or what the modelling snippet is telling us\n- Relate the data being described generally on the page to the example\n\n\n#### R Code Style\n\nFor pipes we try use `|>` not `%>%` though sometimes this isn't possible\n\nWe use [`gt()`](https://gt.rstudio.com)  to make tables.\n\nWhen processing data:\n\n- Pipes should appear at the end of a line and be proceeded by a space\nFilter as early as possible\n- Instead of something like `mutate() |> select()`, use `transmute()`\n- Instead of `select(x) |> as.list()` or similar, consider `pull(x)` which also has a names argument\n- Use `pivot_longer()` and `pivot_wider()` as needed. It is common to use the former before plotting.\n- When coercing to a factor consider using `as_factor()` or `factor(levels=…)`\n- Use indentation to keep track of the flow of your code. For example, if you’ve written `ggplot() +` on one line, the next line should be indented to show that we're still in the “ggplot” context\n- We seldom need to use `group_by()` these days since `summarise()` and friends have a `.by` argument. It was verbose and fussy managing grouped datasets in tidy pipelines before – eg needing to call `ungroup()` or think about using the `.drop` argument in `group_by()`\n- If you aren't sure about something, consult the following in order:\n  - Existing code snippets in Health RADAR\n  - The [tidy style guide](https://style.tidyverse.org)\n  - Another R programmer working on the project – e.g. RM/JN\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}