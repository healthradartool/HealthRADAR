<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-08-30">
<meta name="description" content="ERA5 hourly data on single levels from 1940 to present">

<title>ERA5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-c1f63da3e08f13bc72dc17e92cfd001d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-7b26f514444c863e99e16d2cb2559a3c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "Search",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-H03EKDS8HM"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-H03EKDS8HM', { 'anonymize_ip': true});
</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #212529;
      }

      .quarto-title-block .quarto-title-banner {
        color: #212529;
background: #EDF3F9;
      }
</style>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/Health RADAR Logo Transparent.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../data.html"> 
<span class="menu-text">Browse</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-guides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Guides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-guides">    
        <li>
    <a class="dropdown-item" href="../../../guides/climate/climate.html">
 <span class="dropdown-text">Climate</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../issues.html"> 
<span class="menu-text">Submit an Issue</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/healthradartool/HealthRADAR"> <i class="bi bi-github" role="img" aria-label="RADAR GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
    <div class="quarto-title-banner page-columns page-full">
        <div class="quarto-title column-page">

                        <div class="back-nav"><a id="back-nav-link" href="../../../data.html">← Back to browse</a></div>
                        
            <h1 class="title">ERA5</h1>

            
                        <div>
                <div class="description">
                    ERA5 hourly data on single levels from 1940 to present
                </div>
            </div>
            
                                    <div class="quarto-categories">
                                <div class="quarto-category">climate</div>
                                <div class="quarto-category">gridded</div>
                                <div class="quarto-category">reanalysis</div>
                                <div class="quarto-category">rainfall</div>
                                <div class="quarto-category">temperature</div>
                                <div class="quarto-category">global</div>
                                <div class="quarto-category">hourly</div>
                            </div>
                                </div>
    </div>

    
    <div class="quarto-title-meta column-page">

        
        <div>
        <div class="quarto-title-meta-heading">Last updated</div>
        <div class="quarto-title-meta-contents">
          <p class="date">August 30, 2024</p>
        </div>
      </div>
      
        
      </div>
      
    
</header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page" id="quarto-document-content">




<div class="tabset-margin-container"></div><div class="page-tabs panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Overview</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Visualisations</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Modelling</a></li></ul>
<div class="page-tabs tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<h2 class="anchored">
About the data
</h2>
<p>ERA5 is the fifth-generation reanalysis dataset produced by ECMWF (European Centre for Medium-Range Weather Forecasts), providing a detailed, global view of the climate. Covering the period from 1940 to near real-time, ERA5 combines vast amounts of historical observations with modern weather forecasting models, ensuring a globally complete, physically consistent record. The gridded dataset is available at a high spatial resolution of 0.25° (approximately 28 km by 28 km at the equator, varying slightly by latitude) and offers data at hourly intervals, providing sub-daily time resolution. It includes a wide range of surface and upper-air variables, supporting a broad spectrum of applications and research fields.</p>
<p>ERA5 is continuously updated, with data typically available within about one week of real time. Regular updates and corrections ensure the quality and completeness of the dataset over time.</p>
<p>ECMWF has made several subsets of the ERA5 reanalysis dataset available to meet different user needs. These include distinctions between data provided at pressure levels versus single levels (surface and near-surface variables), and at different temporal resolutions (hourly and monthly averages). For the purposes of this site, we focus on the “ERA5 hourly data on single levels from 1940 to present” subset, which offers high-resolution, near-surface climate variables suitable for a wide range of applications.</p>
<p>For more information regarding ERA5 datasets see <a href="https://confluence.ecmwf.int/display/CKB/ERA5">ERA5-Dataset Documentation</a>.</p>
<p>Users can also find more information about the ERA5 dataset here:</p>
<ul>
<li><p>Climate Data Store: <a href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview">ERA5 hourly data on single levels from 1940 to present</a></p></li>
<li><p>Climate Data Guide: <a href="https://climatedataguide.ucar.edu/climate-data/era5-atmospheric-reanalysis">ERA5 atmospheric reanalysis</a></p></li>
</ul>
<p><strong>Summary</strong></p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td><strong>Name</strong></td>
<td>ERA5 (hourly data on single levels from 1940 to present)</td>
</tr>
<tr class="even">
<td><strong>Institution</strong></td>
<td><a href="https://www.ecmwf.int/">ECMWF</a></td>
</tr>
<tr class="odd">
<td><strong>Product type</strong></td>
<td>reanalysis</td>
</tr>
<tr class="even">
<td><strong>Domain</strong></td>
<td>global</td>
</tr>
<tr class="odd">
<td><strong>Resolution</strong></td>
<td>0.25° x 0.25°</td>
</tr>
<tr class="even">
<td><strong>Period</strong></td>
<td>1940 - near real-time</td>
</tr>
<tr class="odd">
<td><strong>Frequencies</strong></td>
<td>hourly</td>
</tr>
<tr class="even">
<td><strong>Variables</strong></td>
<td>precipitation, temperature, others</td>
</tr>
<tr class="odd">
<td><strong>Update frequency (latency)</strong></td>
<td>daily (+-5 days)</td>
</tr>
</tbody>
</table>
<p><br> <strong>Variables</strong> <br></p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Variable Name</strong></th>
<th><strong>Variable Description</strong></th>
<th><strong>Units</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2m temperature</td>
<td>temperature of air at 2m above the surface of land, sea or inland waters</td>
<td>kelvin</td>
</tr>
<tr class="even">
<td>Total precipitation</td>
<td>accumulated liquid and frozen water, comprising rain and snow, that falls to the Earth’s surface</td>
<td>meters</td>
</tr>
<tr class="odd">
<td>10m u-component of wind</td>
<td>horizontal speed of air moving towards the east, at a height of ten meters above the surface of the Earth</td>
<td>meters per second</td>
</tr>
<tr class="even">
<td>10m v-component of wind</td>
<td>horizontal speed of air moving towards the north, at a height of ten meters above the surface of the Earth</td>
<td>meters per second</td>
</tr>
</tbody>
</table>
<p>For a comprehensive list of variables, you can refer to the dataset’s documentation on the <a href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview">Copernicus Climate Data Store</a>.</p>
<p><br></p>
<h2 class="anchored">
Accessing the data
</h2>
<p>ERA5 is a widely used reanalysis dataset and can be downloaded from several different platforms. We focus here on the <em>ERA5 hourly data on single levels from 1940 to present</em> subset.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Climate Data Store</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">KNMI Climate Explorer</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The ERA5 dataset is provided by the European Centre for Medium-Range Weather Forecasts (ECMWF) through the <a href="https://climate.copernicus.eu/">Copernicus Climate Change Service (C3S)</a>, with the <a href="https://cds.climate.copernicus.eu/">Climate Data Store</a> serving as the primary access point for ERA5 data. Users can download data directly from the <a href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview">ERA5 hourly data on single levels from 1940 to present</a> dataset page. The CDS provides a user-friendly interface for selecting variables, spatial and temporal ranges, and output formats. Data is available in both GRIB and NetCDF formats.</p>
<p>Guidance on how to download ERA5 data via the Climate Data Store is available <a href="https://confluence.ecmwf.int/display/CKB/How+to+download+ERA5">here</a></p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Version</strong></th>
<th><strong>Variables</strong></th>
<th><strong>Resolution</strong></th>
<th><strong>Spatial Extent</strong></th>
<th><strong>File Format</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Latest (updated daily)</td>
<td>2m temperature, Total precipitation, 10m u-component of wind, 10m v-component of wind, 2m dewpoint temperature etc. A comprehensive list is available on the CDS dataset page.</td>
<td>0.25° (~28km x ~28km)</td>
<td>Global/User specified</td>
<td>GRIB (.grib), NetCDF (.nc)</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>The <a href="https://climexp.knmi.nl/start.cgi">KNMI Climate Explorer</a> provides access to ERA5 data with tools for analysis and visualization. The dataset can be specified on their <a href="https://climexp.knmi.nl/selectdailyfield2.cgi?id=someone@somewhere">Daily Select a field page</a>. The ERA5 data available through KNMI is at <em>daily resolution</em>, with an ‘Africa’ subset included. Users can extract data for specific locations or regions and perform statistical analyses directly on the platform. Data provided in NetCDF format.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Version</strong></th>
<th><strong>Variables</strong></th>
<th><strong>Resolution</strong></th>
<th><strong>Spatial Extent</strong></th>
<th><strong>File Format</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Typically up-to-date</td>
<td>A selection of variables including temperature, precipitation, and wind.</td>
<td>0.25° (~28km x ~28km), 0.5° (~55.5km x ~55.5km)</td>
<td>User specified</td>
<td>netCDF (.nc)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h2 class="anchored">
What the data looks likes
</h2>
<p>Below are a few plots to give a better sense of what the ERA5 dataset looks like. The first two are spatial plots over Southern Africa, illustrating the spatial resolution and the coarseness of the 0.25° × 0.25° grid. The final three plots focus on a single grid cell and show the seasonal cycle and time series data for that location.</p>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Fig1_ERA5_MeanRainfall_1991-2020.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Mean annual rainfall over Southern Africa from 1991–2020, derived from ERA5 data. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"><img src="images/Fig1_ERA5_MeanRainfall_1991-2020.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Mean annual rainfall over Southern Africa from 1991–2020, derived from ERA5 data. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"></a></p>
</figure>
</div>
<figcaption>Mean annual rainfall over Southern Africa from 1991–2020, derived from ERA5 data. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Fig2_ERA5_MeanTemperature_1991-2020.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Annual average daily mean temperature over Southern Africa from 1991-2020, derived from ERA5 data. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"><img src="images/Fig2_ERA5_MeanTemperature_1991-2020.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Annual average daily mean temperature over Southern Africa from 1991-2020, derived from ERA5 data. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"></a></p>
</figure>
</div>
<figcaption>Annual average daily mean temperature over Southern Africa from 1991-2020, derived from ERA5 data. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Fig3_ERA5_Climatology_1991-2020.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Monthly climatology of rainfall (bars) and monthly average daily mean (solid line), maximum (dot-dash line) and minimum (dashed line) temperatures, for Mwinilunga, Zambia, for the period 1991-2020, derived from ERA5 data. We see Mwinilunga has very dry and cool winter months (JJA) and experiences it’s hottest period over spring (SON). Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"><img src="images/Fig3_ERA5_Climatology_1991-2020.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Monthly climatology of rainfall (bars) and monthly average daily mean (solid line), maximum (dot-dash line) and minimum (dashed line) temperatures, for Mwinilunga, Zambia, for the period 1991-2020, derived from ERA5 data. We see Mwinilunga has very dry and cool winter months (JJA) and experiences it’s hottest period over spring (SON). Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"></a></p>
</figure>
</div>
<figcaption>Monthly climatology of rainfall (bars) and monthly average daily mean (solid line), maximum (dot-dash line) and minimum (dashed line) temperatures, for Mwinilunga, Zambia, for the period 1991-2020, derived from ERA5 data. We see Mwinilunga has very dry and cool winter months (JJA) and experiences it’s hottest period over spring (SON). Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Fig4_ERA5_daily_TimeSeries_Rainfall_1959-2023.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Daily rainfall time series for Mwinilunga, Zambia, from 1959 to 2023, derived from ERA5 data. We can see daily extreme events Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"><img src="images/Fig4_ERA5_daily_TimeSeries_Rainfall_1959-2023.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Daily rainfall time series for Mwinilunga, Zambia, from 1959 to 2023, derived from ERA5 data. We can see daily extreme events Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"></a></p>
</figure>
</div>
<figcaption>Daily rainfall time series for Mwinilunga, Zambia, from 1959 to 2023, derived from ERA5 data. We can see daily extreme events Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Fig5_ERA5_daily_TimeSeries_Temperatures_1990-1993.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Daily mean, maximum and minimum temperature time series for Mwinilunga, Zambia, from 1990-1993, derived from ERA5 data. We have focused on a four year period to better see the daily temperature fluctuations. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"><img src="images/Fig5_ERA5_daily_TimeSeries_Temperatures_1990-1993.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Daily mean, maximum and minimum temperature time series for Mwinilunga, Zambia, from 1990-1993, derived from ERA5 data. We have focused on a four year period to better see the daily temperature fluctuations. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)"></a></p>
</figure>
</div>
<figcaption>Daily mean, maximum and minimum temperature time series for Mwinilunga, Zambia, from 1990-1993, derived from ERA5 data. We have focused on a four year period to better see the daily temperature fluctuations. Data source: Copernicus Climate Change Service, Climate Data Store, (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on 16-OCT-2024)</figcaption>
</figure>
</div>
</div>
<h2 class="anchored">
Key points to consider
</h2>
<p>ERA5 is a global reanalysis dataset produced by combining model output with a wide range of historical observations using data assimilation techniques. It reflects a blend of satellite, in situ, aircraft, and other observational sources, integrated using the ECMWF Integrated Forecast System (IFS). Through this system, vast amounts of observations are brought together into a consistent model framework, resulting in a physically coherent dataset suitable for climate monitoring and research.</p>
<p>The quality and density of observations vary across space and time, particularly in earlier decades and over data-sparse regions. ERA5 provides uncertainty estimates for many variables through ensemble-based statistics, such as the standard deviation from the 10-member ensemble. These can be used as proxies to assess confidence in the data at specific times and locations.</p>
<p>ERA5 data is available at hourly resolution and can be aggregated to daily or monthly time scales. The dataset includes many surface and atmospheric variables, and its sub-daily time resolution supports detailed temporal analysis. It also enables the derivation of additional variables, such as relative humidity, from core fields like air temperature and dew point temperature. The reanalysis is updated daily with only a few days’ delay, making it suitable for near-real-time analysis. As a model-observation hybrid, ERA5 offers spatially and temporally complete outputs, which can be particularly valuable in regions or periods with limited direct observations.</p>
<p>Users should be aware that the skill of ERA5 data varies by variable, due to how the dataset is produced. ERA5 is derived from a global climate model with fixed spatial resolution, meaning it represents the Earth using a grid. As a result, it can struggle to accurately capture small-scale (‘sub-grid’) processes, such as localized convective rainfall (e.g.&nbsp;thunderstorms). Consequently, rainfall data tends to be less skillful, especially in regions dominated by convective processes or with sparse observational coverage. Temperature data, on the other hand, generally has higher skill, as it is strongly constrained by assimilated observations and tends to be more spatially consistent than rainfall. Comparing ERA5 data with local observations is recommended to assess its reliability.</p>
<p>Specific variables in ERA5 are defined and derived in distinct ways:</p>
<ul>
<li><p>The temperature variable ‘2m temperature’ in ERA5 represents the air temperature at two meters above the surface. Over land, near-surface temperature observations from weather stations are combined with the model output to improve accuracy. However, ERA5 does not explicitly represent urban environments, so it may not fully capture the ‘urban heat island’ effect often observed in cities. Environmental factors such as land type and vegetation also influence the 2 meter temperature. Over the ocean, the 2 meter temperature is strongly influenced by sea surface temperatures (SST), which are derived from a combination of satellite observations (since 1982) and in-situ measurements (prior to 1982).</p></li>
<li><p>The precipitation variable ‘total precipitation’ in ERA5 includes all forms of precipitation (e.g.&nbsp;rain, snow, sleet, and hail). Unlike temperature, precipitation observations are not directly used to adjust the model so the data reflects the model’s best estimate based on its representation of physical processes. However, ERA5’s precipitation is influenced by other observations, such as satellite measurements of humidity in the atmosphere. ERA5 precipitation estimates rely heavily on parameterizations (simplified equations) to represent small-scale (‘sub-grid’) processes like thunderstorms, which can reduce accuracy in certain regions.</p></li>
<li><p>The wind vector variables ‘10m u-component’ and ‘10m v-component’ in ERA5 represent the U (east-west) and V (north-south) wind components 10 meters above the surface. These variables are not directly predicted by the model and are calculated from the model’s surface and atmospheric conditions outputs. Observational data is combined with the model outputs to provide the best estimate of near-surface wind conditions.</p></li>
</ul>
<h3 class="anchored">
Strengths
</h3>
<ul>
<li>Provides a consistent, physically-based reconstruction of weather and climate over time.</li>
<li>Offers hourly data since 1940, allowing analysis at high temporal resolution.</li>
<li>Covers a wide range of variables, useful for many climate-health applications, including malaria modelling.</li>
<li>Includes ensemble-based uncertainty estimates for many parameters.</li>
</ul>
<h3 class="anchored">
Limitations
</h3>
<ul>
<li>The accuracy of ERA5 depends on the quality and availability of assimilated observations, which are limited in some regions and periods (especially before the satellite era or over data-sparse regions like parts of Africa).</li>
<li>It is not an observational dataset but a model–observation hybrid; as such, it may smooth or misrepresent localized extremes or fine-scale variability.</li>
<li>Can be complex and data-intensive to work with.</li>
</ul>
<h2 class="anchored">
Citing the data
</h2>
<p>Hersbach, H., Bell, B., Berrisford, P., Biavati, G., Horányi, A., Muñoz Sabater, J., Nicolas, J., Peubey, C., Radu, R., Rozum, I., Schepers, D., Simmons, A., Soci, C., Dee, D., Thépaut, J-N. (2023): ERA5 hourly data on single levels from 1940 to present. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), DOI: 10.24381/cds.adbb2d47 (Accessed on DD-MMM-YYYY)</p>
<h3 class="anchored">
Terms of use
</h3>
<p>All users of data uploaded on the Climate Data Store (CDS) must:</p>
<ul>
<li>provide clear and visible attribution to the Copernicus programme by referencing the web catalogue entry</li>
<li>acknowledge according to the data licence</li>
<li>cite each product used</li>
</ul>
<p>For guidance on acknowledging or citing the Climate Data Store, see this <a href="https://confluence.ecmwf.int/display/CKB/How+to+acknowledge+and+cite+a+Climate+Data+Store+%28CDS%29+catalogue+entry+and+the+data+published+as+part+of+it">page</a>. For an example of how to cite ERA5 data specifically, refer to this <a href="https://confluence.ecmwf.int/display/CKB/Use+Case+2%3A+ERA5+hourly+data+on+single+levels+from+1940+to+present">ERA5 use case</a>.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<h2 class="anchored">
How to plot this data?
</h2>
<p>In this example, we demonstrate how to visualise ERA5 data using the <a href="https://era-explorer.climate.copernicus.eu">ERA Explorer</a> application provided by <a href="https://cds.climate.copernicus.eu">Climate Data Store (CDS)</a>. The ERA Explorer application allows users to explore the historical climate for anywhere on earth using the ERA5 reanalysis dataset and focuses on four key variables, temperature, rainfall, wind and humidity, all of which are important for Malaria modelling. In the below example we will focus on two different locations in southern Africa.</p>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Vis_Fig1_ERA-Explorer_homepage.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Fig. 1: ERA Explorer Landing page"><img src="images/Vis_Fig1_ERA-Explorer_homepage.png" class="img-fluid figure-img" alt="Fig. 1: ERA Explorer Landing page"></a></p>
<figcaption>Fig. 1: ERA Explorer Landing page</figcaption>
</figure>
</div>
</div>
<p>Users can select a location of interest by clicking on the global interactive map. The application then calculates a set of climate statistics for the selected grid cell (0.25° x 0.25° resolution), which are displayed as a series of plots. These plots can be downloaded as PNG images, and the underlying data can be downloaded in CSV format. The site also links to example Python notebooks to help users understand, replicate, or customize the code.</p>
<pre><code>Note: The data represents average conditions for the entire grid cell, not the precise local environment. </code></pre>
<p>A guidance section, accessible via the “?” icon, provides information on how to use the app; the organisation, the ERA5 dataset and about the data, and how to interpret the plots presented in the app.</p>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Vis_Fig2_About_ERA-Explorer.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Fig. 2: Guidance documentation popup for the ERA Explorer Application"><img src="images/Vis_Fig2_About_ERA-Explorer.png" class="img-fluid figure-img" alt="Fig. 2: Guidance documentation popup for the ERA Explorer Application"></a></p>
<figcaption>Fig. 2: Guidance documentation popup for the ERA Explorer Application</figcaption>
</figure>
</div>
</div>
<p>To illustrate, two locations in southern Africa with contrasting climates were selected (Fig. 3):</p>
<ul>
<li>Kariba, Zimbabwe</li>
<li>Mbabane, Eswatini</li>
</ul>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Vis_Fig3_ERA-Explorer_compare_locations.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Fig. 3: ERA Explorer showing the two selected locations"><img src="images/Vis_Fig3_ERA-Explorer_compare_locations.png" class="img-fluid figure-img" alt="Fig. 3: ERA Explorer showing the two selected locations"></a></p>
<figcaption>Fig. 3: ERA Explorer showing the two selected locations</figcaption>
</figure>
</div>
</div>
<p>The ERA Explorer provides several types of visualisations which include:</p>
<ul>
<li>Monthly climatologies (temperature, rainfall and relative humidity)</li>
<li>Annual timeseries (temperature and rainfall)</li>
<li>Annual anomalies (temperature)</li>
<li>Daily climatologies (temperature)</li>
<li>Hourly climatologies (wind)</li>
</ul>
<p>Each plot is generated automatically, with a brief explanation below describing the method used. While most plots look straightforward, some involve complex processing—particularly those showing relative humidity or hourly wind climatologies.</p>
<p>If users wish to generate their own plots, it is recommended to download the data from the application and to refer to the example python notebooks provided.</p>
<h3 class="anchored">
Monthly Climatologies
</h3>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Temperature_monthly_climatology_26.30S31.17E_16.52S28.80E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Monthly temperature climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. We can see Kariba is consistently warmer than Mbabane throughout the year. Kariba’s temperatures peak in spring (Sept–Nov), while Mbabane experiences its warmest temperatures in summer (Dec–Feb). Both locations have their coolest periods in winter (Jun–Aug). Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Temperature_monthly_climatology_26.30S31.17E_16.52S28.80E.png" class="img-fluid figure-img" alt="Monthly temperature climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. We can see Kariba is consistently warmer than Mbabane throughout the year. Kariba’s temperatures peak in spring (Sept–Nov), while Mbabane experiences its warmest temperatures in summer (Dec–Feb). Both locations have their coolest periods in winter (Jun–Aug). Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Monthly temperature climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. We can see Kariba is consistently warmer than Mbabane throughout the year. Kariba’s temperatures peak in spring (Sept–Nov), while Mbabane experiences its warmest temperatures in summer (Dec–Feb). Both locations have their coolest periods in winter (Jun–Aug). Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Precip_monthly_climatology_26.30S31.17E_16.52S28.80E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Monthly precipitation climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. Both locations experience a distinct wet season from November to March, with Kariba generally receiving more rainfall during the early summer months (Dec–Feb). Kariba has an extended dry season from May to October, while Mbabane tends to receive more consistent rainfall throughout its drier season. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Precip_monthly_climatology_26.30S31.17E_16.52S28.80E.png" class="img-fluid figure-img" alt="Monthly precipitation climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. Both locations experience a distinct wet season from November to March, with Kariba generally receiving more rainfall during the early summer months (Dec–Feb). Kariba has an extended dry season from May to October, while Mbabane tends to receive more consistent rainfall throughout its drier season. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Monthly precipitation climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. Both locations experience a distinct wet season from November to March, with Kariba generally receiving more rainfall during the early summer months (Dec–Feb). Kariba has an extended dry season from May to October, while Mbabane tends to receive more consistent rainfall throughout its drier season. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Humidity_monthly_climatology_26.30S31.17E_16.52S28.80E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Monthly precipitation climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. Mbabane generally exhibits higher relative humidity than Kariba throughout the year. While both locations experience lower humidity during the dry season, Kariba shows a more pronounced drop during the hot, dry months of early spring (Sept–Oct), whereas Mbabane’s lowest levels occur during the cooler winter months (Jun–Aug).Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Humidity_monthly_climatology_26.30S31.17E_16.52S28.80E.png" class="img-fluid figure-img" alt="Monthly precipitation climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. Mbabane generally exhibits higher relative humidity than Kariba throughout the year. While both locations experience lower humidity during the dry season, Kariba shows a more pronounced drop during the hot, dry months of early spring (Sept–Oct), whereas Mbabane’s lowest levels occur during the cooler winter months (Jun–Aug).Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Monthly precipitation climatology for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1991-2020. Mbabane generally exhibits higher relative humidity than Kariba throughout the year. While both locations experience lower humidity during the dry season, Kariba shows a more pronounced drop during the hot, dry months of early spring (Sept–Oct), whereas Mbabane’s lowest levels occur during the cooler winter months (Jun–Aug).Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
</div>
<h3 class="anchored">
Annual Timeseries
</h3>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Temperature_annual_timeseries_26.30S31.17E_16.52S28.80E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Annual average temperature for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1940-2024. Kariba is consistently around 8°C warmer than Mbabane. A clear warming trend is evident in both locations. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Temperature_annual_timeseries_26.30S31.17E_16.52S28.80E.png" class="img-fluid figure-img" alt="Annual average temperature for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1940-2024. Kariba is consistently around 8°C warmer than Mbabane. A clear warming trend is evident in both locations. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Annual average temperature for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1940-2024. Kariba is consistently around 8°C warmer than Mbabane. A clear warming trend is evident in both locations. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Precip_annual_timeseries_26.30S31.17E_16.52S28.80E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Annual total precipitation for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1940-2024. Mbabane consistently receives more annual rainfall than Kariba, with both locations showing high interannual variability. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Precip_annual_timeseries_26.30S31.17E_16.52S28.80E.png" class="img-fluid figure-img" alt="Annual total precipitation for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1940-2024. Mbabane consistently receives more annual rainfall than Kariba, with both locations showing high interannual variability. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Annual total precipitation for Kariba (Zimbabwe) and Mbabane (Eswatini) for the period 1940-2024. Mbabane consistently receives more annual rainfall than Kariba, with both locations showing high interannual variability. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
</div>
<h3 class="anchored">
Daily Climatologies
</h3>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Temperature_daily_climatology_16.52S28.80E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Daily temperature climatology for Kariba (Zimbabwe) for the period 1991-2020. There are distinct cool and warm periods throughout the year. The hottest days and nights occur in late October to early November, while the coldest are observed in early July. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Temperature_daily_climatology_16.52S28.80E.png" class="img-fluid figure-img" alt="Daily temperature climatology for Kariba (Zimbabwe) for the period 1991-2020. There are distinct cool and warm periods throughout the year. The hottest days and nights occur in late October to early November, while the coldest are observed in early July. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Daily temperature climatology for Kariba (Zimbabwe) for the period 1991-2020. There are distinct cool and warm periods throughout the year. The hottest days and nights occur in late October to early November, while the coldest are observed in early July. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Temperature_daily_climatology_26.30S31.17E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Daily temperature climatology for Mbabane (Eswatini) for the period 1991-2020. The coldest days and nights occur in early July, while the warmest temperatures are more broadly distributed across the summer months (Dec–Feb), rather than peaking in a single period. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Temperature_daily_climatology_26.30S31.17E.png" class="img-fluid figure-img" alt="Daily temperature climatology for Mbabane (Eswatini) for the period 1991-2020. The coldest days and nights occur in early July, while the warmest temperatures are more broadly distributed across the summer months (Dec–Feb), rather than peaking in a single period. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Daily temperature climatology for Mbabane (Eswatini) for the period 1991-2020. The coldest days and nights occur in early July, while the warmest temperatures are more broadly distributed across the summer months (Dec–Feb), rather than peaking in a single period. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
</div>
<h3 class="anchored">
Hourly Climatologies
</h3>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Wind_annual_climatology_16.52S28.80E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Hourly climatological wind rose for Kariba (Zimbabwe) for the period 1991-2020. Wind direction is highly unidirectional with very little variation, indicating a dominant prevailing wind. The wind speed does vary, suggesting changes in intensity even though the direction remains relatively consistent. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Wind_annual_climatology_16.52S28.80E.png" class="img-fluid figure-img" alt="Hourly climatological wind rose for Kariba (Zimbabwe) for the period 1991-2020. Wind direction is highly unidirectional with very little variation, indicating a dominant prevailing wind. The wind speed does vary, suggesting changes in intensity even though the direction remains relatively consistent. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Hourly climatological wind rose for Kariba (Zimbabwe) for the period 1991-2020. Wind direction is highly unidirectional with very little variation, indicating a dominant prevailing wind. The wind speed does vary, suggesting changes in intensity even though the direction remains relatively consistent. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Wind_annual_climatology_26.30S31.17E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Hourly climatological wind rose for Mbabane (Eswatini) for the period 1991-2020. The wind rose indicates that winds come from multiple directions, with a few directions (Westly, West Noth-Westly and South-Eastly) more common than others. This suggests a moderately variable wind regime without a single dominant direction. Wind speeds also show a wide range of variability. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Wind_annual_climatology_26.30S31.17E.png" class="img-fluid figure-img" alt="Hourly climatological wind rose for Mbabane (Eswatini) for the period 1991-2020. The wind rose indicates that winds come from multiple directions, with a few directions (Westly, West Noth-Westly and South-Eastly) more common than others. This suggests a moderately variable wind regime without a single dominant direction. Wind speeds also show a wide range of variability. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Hourly climatological wind rose for Mbabane (Eswatini) for the period 1991-2020. The wind rose indicates that winds come from multiple directions, with a few directions (Westly, West Noth-Westly and South-Eastly) more common than others. This suggests a moderately variable wind regime without a single dominant direction. Wind speeds also show a wide range of variability. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
</div>
<h3 class="anchored">
Annual Anomalies
</h3>
<div class="cell">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Temperature_warming_stripes_26.30S31.17E_16.52S28.80E.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Climate warming stripes (annual temperature anomalies relative to the 1961–2010 reference period) for Kariba (Zimbabwe) and Mbabane (Eswatini) for 1940–2024. A clear concentration of red shades in recent decades highlights a warming trend at both locations. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"><img src="images/Temperature_warming_stripes_26.30S31.17E_16.52S28.80E.png" class="img-fluid figure-img" alt="Climate warming stripes (annual temperature anomalies relative to the 1961–2010 reference period) for Kariba (Zimbabwe) and Mbabane (Eswatini) for 1940–2024. A clear concentration of red shades in recent decades highlights a warming trend at both locations. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/"></a></p>
<figcaption>Climate warming stripes (annual temperature anomalies relative to the 1961–2010 reference period) for Kariba (Zimbabwe) and Mbabane (Eswatini) for 1940–2024. A clear concentration of red shades in recent decades highlights a warming trend at both locations. Source: Copernicus Climate Change Service (C3S). (2025). ERA Explorer [Web application]. Retrieved from https://era-explorer.climate.copernicus.eu/</figcaption>
</figure>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<h2 class="anchored">
How can this data be used in disease modelling?
</h2>
<p>In endemic countries with year-round transmission, malaria cases still peak during the rainy season (November to April for most southern African countries). During this time, temperature and rainfall conditions favour vector development, thereby increasing the total mosquito population. A few specific malaria variables have been experimentally shown to be temperature-sensitive (Shapiro 2017; Suh 2024):</p>
<ul>
<li>The parasite extrinsic incubation period</li>
<li>Vector gonotrophic cycle</li>
<li>Human biting rate</li>
<li>Daily survival/death rate of larval and adult vectors</li>
<li>The egg to adult development rate</li>
</ul>
<p>The egg to adult development rate is also rainfall-sensitive, as is oviposition and the carrying capacity of the environment.</p>
<section id="preparing-the-data" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-data">Preparing the data</h3>
<p>Using the CRU TS dataset, we obtain specific values for temperature over time, and model the historic impact of climatology on the vector population and subsequent incidence. We use mean air temperature as a proxy for surface temperatures.</p>
<p>There are different approaches to explicitly include environmental conditions into an infectious disease model. For this example, we use three equations from Traore (2017) and Agusto (2015; 2020) defining the effect of climate on the dynamics of malaria transmission. Specifically, the example below describes temperature-dependent human biting rate and mosquito mortality, as well as rainfall-dependent environmental carrying capacity.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>temperature_values <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"data/tas_daily_ERA5_19800101-20231231_Kariba.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">City =</span> <span class="st">"Kariba"</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"data/tas_daily_ERA5_19800101-20231231_Mbabane.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">City =</span> <span class="st">"Mbabane"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, tas, City) <span class="sc">|&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(City) <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tas =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">as_date</span>(time) <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2018-06-29"</span>) <span class="sc">~</span> <span class="fu">mean</span>(<span class="fu">c</span>(tas[<span class="fu">as_date</span>(time) <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2018-06-28"</span>)], tas[<span class="fu">as_date</span>(time) <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2018-07-01"</span>)])),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_date</span>(time) <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2018-06-30"</span>) <span class="sc">~</span> <span class="fu">mean</span>(<span class="fu">c</span>(tas[<span class="fu">as_date</span>(time) <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2018-06-28"</span>)], tas[<span class="fu">as_date</span>(time) <span class="sc">==</span> <span class="fu">ymd</span>(<span class="st">"2018-07-01"</span>)])),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> tas))  <span class="sc">|&gt;</span> <span class="co"># fix outliers in 2018 due to artefact</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="st">"2014-01-01"</span>) <span class="sc">&amp;</span> time <span class="sc">&lt;=</span> <span class="fu">ymd</span>(<span class="st">"2023-12-31"</span>) <span class="co"># start date of data</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temperature_values, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> tas, <span class="at">colour =</span> City)) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_health_radar</span>() <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual_health_radar</span>() <span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_wrap</span>(<span class="st">"Daily Mean Surface Air Temperature values in Kariba and Mbabane from 2014 to 2023"</span>, <span class="at">width =</span> <span class="dv">50</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Temperature values (Celsius °)"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">str_wrap</span>(<span class="st">"Changes in temperature over time. Kariba has higher temperatures on average, which may impact vector competence, depending on the primary Anopheles vector in the area and its behavioural habits. Source: tas daily ERA5"</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="era5_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="era5_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>rainfall_values <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>( <span class="fu">read_csv</span>(<span class="st">"data/PRCPTOT_daily_ERA5_19800101-20231231_Kariba.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">City =</span> <span class="st">"Kariba"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"data/PRCPTOT_daily_ERA5_19800101-20231231_Mbabane.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">City =</span> <span class="st">"Mbabane"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(time, pr, City) <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="st">"2014-01-01"</span>) <span class="sc">&amp;</span> time <span class="sc">&lt;=</span> <span class="fu">ymd</span>(<span class="st">"2023-12-31"</span>) <span class="co"># start date of data</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> rainfall_values, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> pr, <span class="at">colour =</span> City)) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual_health_radar</span>() <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_health_radar</span>() <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Daily Precipitation in Kariba and Mbabane from 2014 to 2023"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rainfall values (mm)"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">str_wrap</span>(<span class="st">"Changes in rainfall over time. Mbabane appears to have more rainfall on average, as well as higher peaks with rainfall over 40 mm between 2020 and 2022. Source: PRCPTOT_daily_ERA5"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="era5_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="era5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We incorporate these values into the mathematical model. Note that other models may include other variables such as altitude and humidity. For this example we will explore the mosquito populations and incidence in both cities, as influenced by the environmental conditions. We achieve this by assuming the same parameters and starting conditions in both cities, and only varying the inputs for rainfall and temperature.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time points for the simulation</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="dv">10</span> <span class="co"># Years of simulation</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">365</span><span class="sc">*</span>Y, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rainfall values for each city</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>rains_kariba <span class="ot">&lt;-</span> (<span class="fu">filter</span>(rainfall_values, City <span class="sc">==</span> <span class="st">"Kariba"</span>))<span class="sc">$</span>pr</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>rains_mbabane <span class="ot">&lt;-</span> (<span class="fu">filter</span>(rainfall_values, City <span class="sc">==</span> <span class="st">"Mbabane"</span>))<span class="sc">$</span>pr</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature values for each city</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>temps_kariba <span class="ot">&lt;-</span> (<span class="fu">filter</span>(temperature_values, City <span class="sc">==</span> <span class="st">"Kariba"</span>))<span class="sc">$</span>tas</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>temps_mbabane <span class="ot">&lt;-</span> (<span class="fu">filter</span>(temperature_values, City <span class="sc">==</span> <span class="st">"Mbabane"</span>))<span class="sc">$</span>tas</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># SEACR-SEI model</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>seacr <span class="ot">&lt;-</span> <span class="cf">function</span>(times, start, parameters, rains_vec, temp_vec) { </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(start, parameters)), {</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    P <span class="ot">=</span> S <span class="sc">+</span> E <span class="sc">+</span> A <span class="sc">+</span> C <span class="sc">+</span> R <span class="sc">+</span> G</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    M <span class="ot">=</span> Sm <span class="sc">+</span> Em <span class="sc">+</span> Im</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">=</span> M <span class="sc">/</span> P</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    t_day <span class="ot">&lt;-</span> <span class="fu">floor</span>(times) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    t_day <span class="ot">&lt;-</span> <span class="fu">pmin</span>(t_day, <span class="fu">length</span>(rains_vec))  <span class="co"># prevent out-of-bounds</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    rain <span class="ot">&lt;-</span> rains_vec[t_day]</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> temp_vec[t_day]</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Temperature-dependent equations obtained from Traore 2017 and Agusto 2020</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># biting rate</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="fl">0.00014</span><span class="sc">*</span>temp<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.027</span><span class="sc">*</span>temp <span class="sc">-</span> <span class="fl">0.322</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># daily oviposition rate</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    ovi <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="sc">-</span><span class="fl">0.153</span><span class="sc">*</span>temp<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">8.61</span><span class="sc">*</span>temp <span class="sc">-</span> <span class="fl">97.7</span>, <span class="dv">0</span>) <span class="co"># prevent values going below zero</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># death rate</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    mu_m <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="sc">-</span><span class="fl">0.000828</span><span class="sc">*</span>temp<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.0367</span><span class="sc">*</span>temp <span class="sc">+</span> <span class="fl">0.522</span>)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># carrying capacity</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">max</span>(Km<span class="sc">*</span>(rain<span class="sc">+</span><span class="dv">1</span>), <span class="dv">1</span>)  <span class="co"># ensure K stays above 1000</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Force of infection</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    Infectious <span class="ot">=</span> C <span class="sc">+</span> zeta_a<span class="sc">*</span>A <span class="co">#infectious reservoir</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    lambda.v <span class="ot">&lt;-</span> a<span class="sc">*</span>M<span class="sc">/</span>P<span class="sc">*</span>b<span class="sc">*</span>Im<span class="sc">/</span>M</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    lambda.h <span class="ot">&lt;-</span> a<span class="sc">*</span>c<span class="sc">*</span>Infectious<span class="sc">/</span>P</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Differential equations/rate of change</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    dSm <span class="ot">=</span> ovi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>M<span class="sc">/</span>K)<span class="sc">*</span>M <span class="sc">-</span> lambda.h<span class="sc">*</span>Sm <span class="sc">-</span> mu_m<span class="sc">*</span>Sm</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    dEm <span class="ot">=</span> lambda.h<span class="sc">*</span>Sm <span class="sc">-</span> (gamma_m <span class="sc">+</span> mu_m)<span class="sc">*</span>Em</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    dIm <span class="ot">=</span> gamma_m<span class="sc">*</span>Em <span class="sc">-</span> mu_m<span class="sc">*</span>Im</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    dS <span class="ot">=</span> mu_h<span class="sc">*</span>P <span class="sc">-</span> lambda.v<span class="sc">*</span>S <span class="sc">+</span> rho<span class="sc">*</span>R <span class="sc">-</span> mu_h<span class="sc">*</span>S</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    dE <span class="ot">=</span> lambda.v<span class="sc">*</span>S <span class="sc">-</span> (gamma_h <span class="sc">+</span> mu_h)<span class="sc">*</span>E</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    dA <span class="ot">=</span> pa<span class="sc">*</span>gamma_h<span class="sc">*</span>E <span class="sc">+</span> pa<span class="sc">*</span>gamma_h<span class="sc">*</span>G <span class="sc">-</span> (delta <span class="sc">+</span> mu_h)<span class="sc">*</span>A</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    dC <span class="ot">=</span> (<span class="dv">1</span><span class="sc">-</span>pa)<span class="sc">*</span>gamma_h<span class="sc">*</span>E <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>pa)<span class="sc">*</span>gamma_h<span class="sc">*</span>G <span class="sc">-</span> (r <span class="sc">+</span> mu_h)<span class="sc">*</span>C</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    dR <span class="ot">=</span> delta<span class="sc">*</span>A <span class="sc">+</span> r<span class="sc">*</span>C <span class="sc">-</span> (lambda.v <span class="sc">+</span> rho <span class="sc">+</span> mu_h)<span class="sc">*</span>R</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    dG <span class="ot">=</span> lambda.v<span class="sc">*</span>R <span class="sc">-</span> (gamma_h <span class="sc">+</span> mu_h)<span class="sc">*</span>G</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    dCInc <span class="ot">=</span> lambda.v<span class="sc">*</span>(S<span class="sc">+</span>R)</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Output</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">c</span>(dSm, dEm, dIm, dS, dE, dA, dC, dR, dG, dCInc))</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial values for compartments (we use the same starting values for both cities here)</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Kariba, Zimbabwe </span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>initial_state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Sm =</span> <span class="dv">50000</span>, <span class="co"># susceptible mosquitoes</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Em =</span> <span class="dv">30000</span>, <span class="co"># exposed and infected mosquitoes</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Im =</span> <span class="dv">10000</span>, <span class="co"># infectious mosquitoes</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>                   <span class="at">S =</span> <span class="dv">25000</span>, <span class="co"># susceptible humans</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>                   <span class="at">E =</span> <span class="dv">8000</span>, <span class="co"># exposed and infected humans</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>                   <span class="at">A =</span> <span class="dv">7000</span>, <span class="co"># asymptomatic and infectious humans</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>                   <span class="at">C =</span> <span class="dv">4000</span>, <span class="co"># clinical and symptomatic humans</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>                   <span class="at">R =</span> <span class="dv">5000</span>, <span class="co"># recovered and semi-immune humans</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>                   <span class="at">G =</span> <span class="dv">1000</span>, <span class="co"># secondary-exposed and infected humans</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>                   <span class="at">CInc =</span> <span class="dv">0</span> <span class="co"># cumulative incidence</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Country-specific parameters should be obtained from literature review and expert knowledge</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="co">#a = 0.45, # human biting rate</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>                <span class="at">b =</span> <span class="fl">0.5</span>, <span class="co"># probability of transmission from mosquito to human</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>                <span class="at">c =</span> <span class="fl">0.5</span>, <span class="co"># probability of transmission from human to mosquito</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>                <span class="at">r =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">21</span>, <span class="co"># rate of loss of infectiousness after treatment</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>                <span class="at">rho =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">160</span>, <span class="co"># rate of loss of immunity after recovery</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>                <span class="at">delta =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">150</span>, <span class="co"># natural recovery rate</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>                <span class="at">zeta_a =</span> <span class="fl">0.4</span>, <span class="co"># relative infectiousness of of asymptomatic infections</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">pa =</span> <span class="fl">0.4</span>, <span class="co"># probability of asymptomatic infection</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>                <span class="co">#mu_m = 1/10, # birth and death rate of mosquitoes</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>                <span class="at">mu_h =</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">62</span><span class="sc">*</span><span class="dv">365</span>), <span class="co"># birth and death rate of humans</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>                <span class="at">gamma_m =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="co"># extrinsic incubation rate of parasite in mosquitoes</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>                <span class="at">gamma_h =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="co"># extrinsic incubation rate of parasite in humans</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>                <span class="at">Km =</span> <span class="dv">50000</span> <span class="co"># carrying capacity for mosquito egg laying and pupae and larval development</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Run both models</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>outK <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> initial_state, </span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>           <span class="at">times =</span> times, </span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>           <span class="at">func =</span> seacr, </span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>           <span class="at">parms =</span> parameters,</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>           <span class="at">rains_vec =</span> rains_kariba,</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>           <span class="at">temp_vec =</span> temps_kariba)</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>outM <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> initial_state, </span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>           <span class="at">times =</span> times, </span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>           <span class="at">func =</span> seacr, </span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>           <span class="at">parms =</span> parameters,</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>           <span class="at">rains_vec =</span> rains_mbabane,</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>           <span class="at">temp_vec =</span> temps_mbabane) </span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-processing model output into a dataframe</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>dfK <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">as.data.frame</span>(outK)) <span class="sc">|&gt;</span> </span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">P =</span> S <span class="sc">+</span> E <span class="sc">+</span> A <span class="sc">+</span> C <span class="sc">+</span> R <span class="sc">+</span> G,</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>         <span class="at">M =</span> Sm <span class="sc">+</span> Em <span class="sc">+</span> Im,</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>         <span class="at">Inc =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(CInc))) <span class="sc">|&gt;</span></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ymd</span>(<span class="st">"2014-01-01"</span>) <span class="sc">+</span> time, </span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>         <span class="at">City =</span> <span class="st">"Kariba"</span>)</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>dfM <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">as.data.frame</span>(outM)) <span class="sc">|&gt;</span> </span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">P =</span> S <span class="sc">+</span> E <span class="sc">+</span> A <span class="sc">+</span> C <span class="sc">+</span> R <span class="sc">+</span> G,</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>         <span class="at">M =</span> Sm <span class="sc">+</span> Em <span class="sc">+</span> Im,</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>         <span class="at">Inc =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(CInc))) <span class="sc">|&gt;</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>time, <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ymd</span>(<span class="st">"2014-01-01"</span>) <span class="sc">+</span> time, </span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>         <span class="at">City =</span> <span class="st">"Mbabane"</span>)</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dfK, dfM) <span class="sc">|&gt;</span></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(City)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="changes-in-vector-population" class="level3">
<h3 class="anchored" data-anchor-id="changes-in-vector-population">Changes in vector population</h3>
<p>As mentioned earlier, environmental conditions affect the parasite and mosquito development, and as such we anticipate changes in the vector population to mimic the pattern in the temperature. In this example, we assume the human population stays constant as is shown in the panel on the right. The <a href="https://uct-masha.quarto.pub/healthradar/datasources/malaria/un-population/un_population.html">UN Population Data portal page</a> describes human population growth in the context of disease modelling. In this example, we assume that the human population remains constant, and that humans can be exposed to and infected by an infectious mosquito while recovering from an initial infection (secondary infection).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"M"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, <span class="at">colour =</span> City)) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_health_radar</span>() <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual_health_radar</span>() <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" M"</span>, <span class="at">scale =</span> <span class="fl">1e-6</span>)) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mosquito vector populations over time"</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Population size"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Population"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">str_wrap</span>(<span class="st">"Changes in the total mosquito population mimic seasonal changes in temperature and rainfall values over time, with peaks in the summer months. We see quite large mosquito populations in Mbabane between 2020 and 202, possibly linked to the higher rainfall values during that time. Source: Model output"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="era5_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="era5_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="implications-for-transmission" class="level3">
<h3 class="anchored" data-anchor-id="implications-for-transmission">Implications for transmission</h3>
<p>The force of infection (i.e.&nbsp;the rate at which susceptible individuals become infected per unit time) is largely driven by the human biting rate, the ratio of vectors relative to hosts, the probability of transmission and the size of the infectious reservoir. Below, we see how the temperature has driven the rate of new cases through the temperature-dependent variables.</p>
<p>This is especially insightful when the model includes periods of time impacted by severe environmental conditions such as drought or flooding, and the consequences on malaria transmission dynamics are reflected in the incidence values. Note that the example below is not an actual reflection of malaria transmission in Kariba or Mbabane, and is merely illustrative. We plot the modelled clinical cases for the years 2014 to 2023, however, in reality the value of reported clinical cases may be smaller due to limitations in treatment access, availability of rapid diagnostic tests, and even test sensitivity.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"C"</span>, time <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, <span class="at">colour =</span> City)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_health_radar</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual_health_radar</span>() <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Daily symptomatic cases values in the human population"</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of cases"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">str_wrap</span>(<span class="st">"There are more cases during the summer months, where environmental conditions are suitable for mosquito breeding and malaria transmission. In Mbabane, case numbers rise sharply in the wet season and drop to near zero in the dry season, indicating a high seasonal amplitude. Kariba, however, displays sustained transmission throughout the year (even during winter), leading to a higher overall case burden annually. Source: Model output."</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="era5_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="era5_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="policy-implications" class="level3">
<h3 class="anchored" data-anchor-id="policy-implications">Policy implications</h3>
<p>Models that incorporate temperature and rainfall explicitly may be used to forecast seasonal or year-to-year transmission patterns. This can be used to enable early warning systems for malaria outbreaks, as well as for temporal planning of interventions such as indoor residual spraying (IRS) for maximum impact. This approach also promotes multidisciplinary collaboration for policymakers across health, environmental, and climate sciences.</p>
</section>
<section id="citations" class="level3">
<h3 class="anchored" data-anchor-id="citations">Citations</h3>
<ul>
<li>Agusto F. B., Gumel A. B., &amp; Parham P. E. Qualitative assessment of the role of temperature variations on malaria transmission dynamics. Journal of Biological Systems, 23(04), 1550030 (2015). <a href="https://doi.org/10.1142/S0218339015500308" class="uri">https://doi.org/10.1142/S0218339015500308</a></li>
<li>Agusto F.B. Optimal control and temperature variations of malaria transmission dynamics. Complexity, 1, 5056432 (2020). <a href="https://doi.org/10.1155/2020/5056432" class="uri">https://doi.org/10.1155/2020/5056432</a></li>
<li>Traoré B., Sangaré B., Traoré S. A mathematical model of malaria transmission with structured vector population and seasonality. Journal of Applied Mathematics, 1, 6754097 (2017). <a href="https://doi.org/10.1155/2017/6754097" class="uri">https://doi.org/10.1155/2017/6754097</a></li>
<li>Shapiro L.L.M., Whitehead S.A., &amp; Thomas M.B. Quantifying the effects of temperature on mosquito and parasite traits that determine the transmission potential of human malaria. PLoS Biology 15(10), e2003489 (2017). https://doi.org/10.1371/journal.pbio.2003489</li>
<li>Suh, E., Stopard, I.J., Lambert, B. et al.&nbsp;Estimating the effects of temperature on transmission of the human malaria parasite, Plasmodium falciparum. Nature Communications 15, 3230 (2024). <a href="https://doi.org/10.1038/s41467-024-47265-w" class="uri">https://doi.org/10.1038/s41467-024-47265-w</a></li>
</ul>
</section>
</div>
</div>
</div>



<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/healthradartool\.net");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "healthradartool/HealthRADAR";
    script.dataset.repoId = "R_kgDOJlxA2Q";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "DIC_kwDOJlxA2c4CspTP";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Health RADAR</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../data.html">
<p>Data Sources</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
<div>
<img src="../../../img/wellcome-logo-white.png" width="100px" alt="Wellcome Logo">
<div style="font-size: 1em; color: white; font-weight: 500; margin-top: 10px">
Funded by Wellcome
</div>
</div>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>