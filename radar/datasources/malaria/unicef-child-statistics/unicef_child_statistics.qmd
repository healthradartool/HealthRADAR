---
title: "UNICEF DATA - Child Statistics"
description: "UNICEF DATA - Child Statistics provides detailed information on malaria's impact on children, including prevalence, treatment coverage, and mortality rates."
date: 07/04/2024 # mm-dd-yyyy
image: "images/unicef.png"

categories:
  - malaria
  - epidemiology
  - country-level
  - annual
  - children
---

::: {.page-tabs .panel-tabset}

## Overview

<h2>About the data</h2>

UNICEF DATA - Child Statistics provides data on insecticide-treated net (ITN) use, intermittent preventative treatment for pregnant women (IPTp), and key indicators related to malaria testing and treatment for children in endemic countries. These data are collected using household surveys, primarily Multiple Indicator Cluster Surveys (MICS) and Demographic and Health Surveys (DHS).

They are recorded annually, meaning that the dataset will not be appropriate for investigating seasonal trends in the indicators. For each indicator and country, values can be obtained nationally, by sex, by area (urban or rural), by mother's education level, or by wealth index quintiles (WIQ).

<h2>Accessing the data</h2>

The [UNICEF data website](https://data.unicef.org/) includes access to journal articles, publications, data visualisations, datasets, and other resources related to the data they make available.

Reaching the Child Health Coverage dataset from the [UNICEF data website](https://data.unicef.org/) homepage can be done as follows:

1.  Navigate to the \`Data by Topic' tab, and select the \`Malaria' option from the \`Child and Adolescent Health' subsection to reach [UNICEF's Malaria webpage](https://data.unicef.org/topic/child-health/malaria/#notes).
2.  Scroll down until you see the heading \`Malaria Data'. Select the download button beside the label \`Child Health Coverage'.

The dataset will be downloaded as an Excel file.

<h2>What do the data look like?</h2>

The Excel document has 19 sheets. The first, which will come up when the file is opened, contains a description of each of these sheets, as well as a thorough description of each indicator, how they are calculated, and the primary sources from which they are drawn.

![Layout of the first sheet of the Excel document.](images/malaria_xlsx_index.png)


<h2>Key points to consider</h2>

This dataset is sparse at times. It is rare that a measure recorded in a given year for a given country will be available for many other countries with which you may want to compare it. This makes it most appropriate for exploration, rather than for investigating a time series of a specific variable, or comparing a variable across specific countries in a given year. 

**Pitfalls of Annual Data:**

Using annual data for your analysis can lead to several pitfalls:

-   Seasonal variations: Annual data may not capture the seasonal patterns of malaria transmission, which can be influenced by factors such as rainfall, temperature, and vector abundance. This can lead to an over- or underestimation of the disease burden and the impact of interventions.

-   Temporal aggregation: Aggregating data annually may mask important short-term dynamics, such as outbreaks or the immediate impact of interventions.

**National Level - Ignoring Spatial Heterogeneity:**

Modelling malaria transmission at a national level can overlook important spatial heterogeneities:

-   Regional variations: Malaria transmission can vary significantly between different regions within a country due to differences in climate, vector ecology, and socioeconomic factors.

-   Local hotspots: Even within regions, there can be local hotspots of malaria transmission due to factors such as proximity to breeding sites, population density, and human behavior.

-   Population movement: The movement of people between different areas can introduce or reintroduce malaria parasites, affecting transmission dynamics.

<h2>Examples of data use in literature</h2>

Around 100 UNICEF [journal articles](https://data.unicef.org/resources/resource-type/journal-articles/?f) and over 300 [publications](https://data.unicef.org/resources/resource-type/publications/?f) are made available on the UNICEF data website.


## Visualisations

<h2>How to use the dataset</h2>

This dataset includes information on diarrhoea and pneumonia in addition to the malaria-related data. You can isolate data related to specific variables and countries that are pertinent to your current research. An example of how to do this, in which the Malaria-related variables and E8 countries are selected, is shown in the code chunk below.  

```{r}
#| echo: false

library(tidyverse)
library(deSolve)

source(here::here("radar/theme_health_radar.R"))
```

```{r,2}
# Read in data
data <- readxl::read_xlsx(
  "Child-Health-Coverage-Database-December-2023 .xlsx",
  sheet = "Long"
)

colnames(data) <- data[3, ]
data <- data[4:nrow(data), ]
data$Value <- as.numeric(data$Value)
data$`Latest Year` <- as.numeric(data$`Latest Year`)
data$`Level` <- factor(data$`Level`, levels = c(
  "Richest", "Fourth", "Middle", "Second",
  "Poorest", "National", "Urban", "Rural",
  "Male", "Female", "None", "Primary",
  "Sec & Higher", "15-19"
))

# Select only Malaria Indicators
mal_indicators <- c("IPTP", "ITN", "ITN2", "ITNOWN", "ITNPREG", "MLRACT", "MLRCARE", "MLRDIAG")
mal_dat <- dplyr::filter(data, data$Indicator %in% mal_indicators)

# Select only E8 countries
e8 <- c(
  "Botswana", "Eswatini", "Namibia", "South Africa",
  "Angola", "Mozambique", "Zambia", "Zimbabwe"
)
mal_dat <- dplyr::filter(mal_dat, `Countries and areas` %in% e8)
```

The first ten rows of these data can be seen in the following table:

```{r}
# Produce a table of the first ten rows of data
mal_dat |> 
  head(n = 10) |>
  dplyr::select_if(~ !all(is.na(.)))|>
  gt::gt()
```

Although data manipulation in R is often easiest using a dataframe which is in long format, tables may be easier to interpret in wide format, for example, with each column containing data for a given year. The final ten rows of the above data, converted to wide format, are shown below.  

```{r}
# Produce a table in wide format of the last ten rows of data
mal_dat[,-c(6,8,9)] |> 
  tidyr::pivot_wider(names_from = `Latest Year`,
                     values_from = `Value`) |>
  tail(n = 10) |>
  dplyr::select_if(~ !all(is.na(.)))|>
  gt::gt()
```

<h2>How to plot these data?</h2>

```{r,3}
# Produce a line plot coloured by wealth index quintile
mal_dat|> 
  dplyr::filter(Indicator == "IPTP") |>
  dplyr::filter(`Countries and areas` == "Zambia") |>
  dplyr::filter(Stratifier == "WIQ") |>
  ggplot2::ggplot(aes(x = `Latest Year`, y = Value, group = Level)) + 
    geom_line(aes(col = Level), lwd = 2) + 
    scale_colour_manual_health_radar() + 
    theme_health_radar() + 
    xlab("Year") + 
    ylab("IPTP") + 
    labs(
      title = "Percentage of Pregnant Women who have received IPT",
      subtitle = "Data for Zimbabwe",
      caption = stringr::str_wrap("This plot displays the percentage of Zambian women between 15 and 49 years of age, who received intermittent preventative treatment (IPT) for Malaria at least three times during antenatal clinic visits for their most recent pregnancy, with data recorded between 2007 and 2019, and separated by wealth index quintile. Source: UNICEF Child Health Coverage Dataset.", width = 75),
      x = "Country",
      y = "Percentage"
    ) 
```


```{r,4}
# Produce a paired bar plot coloured by sex
mal_dat |> 
  dplyr::filter(Indicator == "ITN") |>
  dplyr::filter(`Stratifier` == "Sex") |>
  dplyr::filter(`Latest Year` == "2007") |>
  ggplot(aes(x = `Countries and areas`, y = Value, fill = Level)) +
  geom_bar(position = "dodge", stat='identity') + 
  scale_fill_manual_health_radar() + 
  theme_health_radar() + 
  xlab("Year") + 
  ylab("ITN") +
  labs(
    title = "Percentage of Children using an ITN",
    subtitle = "Data for selected African countries",
    caption = stringr::str_wrap("This plot displays the percentage of children  under 5 years of age, separated by sex, who slept under insecticide-treated mosquito nets (ITNs) the night prior to their partcipation in the survey, in Angola, Eswatini, Namibia and Zambia in the year 2007. Source: UNICEF Child Health Coverage Dataset.", width = 75),
    x = "Country",
    y = "Percentage"
  ) 
```

```{r,5}
# Produce a lollipop plot with colours indicating the year for which these data were recorded
mal_dat |> 
  dplyr::filter(Indicator == "ITNPREG") |>
  dplyr::filter(Level == "National") |>
  dplyr::filter(`Latest Year` == 2007 | `Latest Year` == 2018 | `Latest Year` == 2011 | `Latest Year` == 2015 | `Latest Year` == 2014) |>
  ggplot(aes(x = `Countries and areas`, y = Value, colour = as.factor(`Latest Year`))) + 
  geom_segment(aes(x = `Countries and areas`, xend = `Countries and areas`, y = 0, yend = Value), color = "grey") +  # Keep constant grey color for segments
  geom_point(size = 4) +
  coord_flip() +  # Adjust the aspect ratio to make the plot taller
  scale_colour_manual_health_radar() +  # Correct color scale for the discrete 'Source' variable
  theme_health_radar() +
  labs(
    title = "Percentage of Pregnant Women using an ITN",
    subtitle = "Data for selected African countries",
    caption = stringr::str_wrap("This plot displays the percentage of pregnant Zimbabwean, Zambian, Namibian, Mozambiquan, Estwatinian and Angolan women between 15 and 49 years of age, who used insecticide-treated mosquito nets (ITNs) the night prior to their participation in the survey. Records are displayed for the years 2007, 2011, 2014, 2015 and 2018. Source: UNICEF Child Health Coverage Dataset.", width = 75),
    x = "Country",
    y = "Percentage", 
    colour = "Year"
  )
```

## Modelling Example

<h2>How can this data be used in disease modelling?</h2>

Many malaria control interventions are targeted at vulnerable populations, specifically pregnant women and children under the age of five. Similarly, in some countries, ITNs are distributed through antenatal clinics to increase access and usage of prevention methods in these groups.

It is also known that partial immunity to malaria is acquired with age, especially in endemic contexts with repeated exposure. For this reason, young children may be more susceptible to severe disease. In addition, as a vulnerable group, children are more likely to sleep earlier and indoors, limiting their exposure to mosquitoes.

For the age-structured malaria model below, we use data on ITN usage amongst children from the UNICEF dataset. For the rest of the population, we simulate ITN coverage.

### Preparing the data

We filter the data for ITN usage in Zimbabwe. The data also allows stratification by sex, urban/rural, level of mother's education and Wealth Index Quintile (WIQ). For the purposes of this example, we use national level data over time.

```{r}

# ITN usage amongst children
Zim_ITN_use_c <- mal_dat |> 
  filter(`Countries and areas` == "Zimbabwe", Indicator == "ITN", Stratifier == "National") |> 
  mutate(Population = "Children < 5",
         Value = Value/100) %>% 
  mutate(
    Date = ymd(paste0(`Latest Year`, "-01-01")),
    day_index = as.numeric(Date - min(Date)) + 1
  ) # add a day_index for interpolation

ggplot() + 
  geom_point(data = Zim_ITN_use_c, aes(x = `Latest Year`, y = Value, colour = Population)) +
   geom_line(data = Zim_ITN_use_c, aes(x = `Latest Year`, y = Value, colour = Population)) +
  scale_colour_manual_health_radar() + 
  theme_health_radar() +
  scale_y_continuous(labels = scales::label_percent(), limits = c(0, 0.4)) +
  labs(
    title = str_wrap("Children under five years of age sleeping under an ITN in Zimbabwe"),
    x = "Year",
    y = "Percent (%)",
    caption = str_wrap("In this plot we note that ITN usage amongst children under five fluctuates between 4 and 30%. Source: UNICEF Child Health Coverage Dataset.")
  ) +
  guides(colour = "none")

```

We may consider the proportion of the population effectively covered by ITNs to be those with access to at least one ITN and actively using the net. In addition, the effectiveness of the nets at preventing infectious bites decreases over time as chemical efficacy drops and nets are damaged through wear and tear and considered lost. This loss is also called attrition, $attr$. The median survival time of long lasting insecticidal nets (LLINs) is considered to be three years, represented by $eta$ in the model. 

For a more detailed description of the incorporation of ITNs, see the [DHS](https://jfunction.quarto.pub/healthradar/radar/datasources/malaria/dhs-program/dhs.html) page. For this example, we use UNICEF-sourced data to inform an age-structured model in Zimbabwe, depicting two populations: individuals over the age of five, and children under five years old.

### Model assumptions

For the purposes of this model we make the following assumptions:

-   Children under the age of five are 20% more susceptible to mosquito transmission $b$ than children over the age of five and adults
-   Mortality rates $mu_h$ ($\mu_h$) in both age groups are the same
-   The duration of partial immunity $rho$ ($\rho$) in adults is longer in adults because of previous malaria infections
-   Net usage differs in vulnerable populations, specifically children under the age of five. We set usage among adults at 60%.

Consequently, the force of infection $lambda-c$ ($\lambda_c$) in children under the age of five years, that is, the rate at which they are exposed to an infectious vector, will be higher than that in adults. This is due to their increased susceptibility to infection and shorter span of partial immunity.

```{r}
library(deSolve)
# Time points for the simulation
Y = 14 # Years of simulation from 2006 to 2019
times <- seq(0, 365*Y, by = 1)

# Simulate of time-dependent variables of ITN coverage

itncov <- data.frame(time = seq(0, by = 365, length.out = Y),
                     nets = runif(Y, min = 0, max = 1)
                     ) 


## SEACR-SEI model
seacr <- function(times, start, parameters, itncov, Zim_ITN_use_c) { 
  with(as.list(c(start, parameters)), {
    
    P0 = S0 + E0 + A0 + C0 + R0 + G0
    P1 = S1 + E1 + A1 + C1 + R1 + G1
    P = P0 + P1
    M = Sm + Em + Im
    m = M / P
    
    seas =  1+amp*cos(2*pi*(times/365 - phi))
    
    itncovfunc <- approxfun(itncov$time, itncov$nets, times, method = "constant", rule = 2) # ITN access 
    itn_access <- itncovfunc(times)
    
    itnuse_c <- approx(Zim_ITN_use_c$day_index, Zim_ITN_use_c$Value, times, method = "linear", rule = 2)$y # ITN usage among children
    itn_c = min(ITN,1)*itnuse_c*itn_eff
    itn_a = min(ITN,1)*itnuse_a*itn_eff 
    
    eta <- -log(1-(1-attr))/(3*365) # ITN loss due to attrition over 3 years
    
    # Force of infection
    Infectious = C0 + C1 + zeta*(A1+A0) #infectious reservoir
    lambda_a = ((a^2*b_a*c*m*Infectious/P)/(a*c*Infectious/P+mu_m)*(gamma_m/(gamma_m+mu_m)))*seas*(1-itn_a)
    lambda_c = ((a^2*b_c*c*m*Infectious/P)/(a*c*Infectious/P+mu_m)*(gamma_m/(gamma_m+mu_m)))*seas*(1-itn_c)
    
    # Differential equations/rate of change
    
    # Mosquitoes assumed to be at equilibrium
    dSm = 0
    dEm = 0
    dIm = 0
    
    # Children 
    dS0 = mu*P - lambda_c*S0 + rho_c*R0 - mu_h*S0 - kappa_c*S0
    dE0 = lambda_c*S0 - (gamma_h + mu_h + kappa_c)*E0
    dA0 = pa*gamma_h*E0 + pa*gamma_h*G0 - (delta + mu_h + kappa_c)*A0
    dC0 = (1-pa)*gamma_h*E0 + (1-pa)*gamma_h*G0 - (r + mu_h + kappa_c)*C0
    dR0 = delta*A0 + r*C0 - (lambda_c + rho_c + mu_h + kappa_c)*R0
    dG0 = lambda_c*R0 - (gamma_h + mu_h + kappa_c)*G0
    
    # Adults 
    dS1 = kappa_c*S0 - lambda_a*S1 + rho_a*R1 - mu_h*S1
    dE1 = kappa_c*E0 + lambda_a*S1 - (gamma_h + mu_h)*E1
    dA1 = kappa_c*A0 + pa*gamma_h*E1 + pa*gamma_h*G1 - (delta + mu_h)*A1
    dC1 = kappa_c*C0 + (1-pa)*gamma_h*E1 + (1-pa)*gamma_h*G1 - (r + mu_h)*C1
    dR1 = kappa_c*R0 + delta*A1 + r*C1 - (lambda_a + rho_a + mu_h)*R1
    dG1 = kappa_c*G0 + lambda_a*R1 - (gamma_h + mu_h)*G1
    
    dCInc = lambda_c*(S0+R0) + lambda_a*(S1+R1) # total cumulative incidence
    dITN = itn_access - (eta + itn_death)*ITN 
    
    dCInc_c = lambda_c*(S0+R0) # cumulative incidence in children
    dCInc_a = lambda_a*(S1+R1) # cumulative incidence in adults
    
    # Output
    list(c(dSm, dEm, dIm, dS0, dE0, dA0, dC0, dR0, dG0, dS1, dE1, dA1, dC1, dR1, dG1, dCInc, dITN, dCInc_c, dCInc_a))
  })
}


# Initial values for compartments
initial_state <- c(Sm = 10000000, # susceptible mosquitoes
                   Em = 10000000, # exposed and infected mosquitoes
                   Im = 10000000, # infectious mosquitoes
                   S0 = 3000000, # susceptible children
                   E0 = 1500000, # exposed and infected children
                   A0 = 800000, # asymptomatic and infectious children
                   C0 = 500000, # clinical and symptomatic children
                   R0 = 200000, # recovered and semi-immune children
                   G0 = 100000, # secondary-exposed and infected children
                   S1 = 5000000, # susceptible adults
                   E1 = 2500000, # exposed and infected adults
                   A1 = 1000000, # asymptomatic and infectious adults
                   C1 = 700000, # clinical and symptomatic adults
                   R1 = 300000, # recovered and semi-immune adults
                   G1 = 100000, # secondary-exposed and infected adults
                   CInc = 0, # cumulative incidence
                   ITN = 0.5, # proportion of the population with potential to be protected by nets CURRENTLY IN CIRCULATION
                   CInc_c = 0, # cumulative incidence in children
                   CInc_a = 0 # cumulative incidence in adults
)
# Country-specific parameters should be obtained from literature review and expert knowledge
parameters <- c(a = 0.3, # human biting rate
                b_a = 0.35, # probability of transmission from mosquito to adult human
                b_c = 0.48, # probability of transmission from mosquito to child human under the age of five (b_a*1.2)
                c = 0.4, # probability of transmission from human to mosquito
                r = 1/7, # rate of loss of infectiousness after treatment
                rho_c = 1/50, # rate of loss of immunity after recovery in children
                rho_a = 1/160, # rate of loss of immunity after recovery in adults
                delta = 1/200, # natural recovery rate
                zeta = 0.4, # relative infectiousness of of asymptomatic infections
                pa = 0.1, # probability of asymptomatic infection
                mu_m = 1/10, # birth and death rate of mosquitoes
                mu_h = 1/(50*365), # death rate of humans
                mu = (32/1000)/365, # crude birth rate per 1000 humans
                gamma_m = 1/10, # extrinsic incubation rate of parasite in mosquitoes
                gamma_h = 1/10, # extrinsic incubation rate of parasite in humans
                amp = 0.6, #amplitude of seasonality
                phi = 200, #phase angle; start of season
                kappa_c = 1/(30.44*59), # aging rate from the first age group (30.44 days * 59 months)
                attr = 0.55, # nets remaining after 3 years in circulation
                itnuse_a = 0.6, # net usage among the adult population
                itn_eff = 0.45, # effectiveness of ITN at preventing ongoing transmission
                itn_death = 1/(3*365) # median net survival is three years

)

# Run the model

out <- ode(
  y = initial_state, 
  times = times, 
  func = seacr, 
  parms = parameters,
  itncov = itncov,
  Zim_ITN_use_c = Zim_ITN_use_c
)


# Post-processing model output into a dataframe

df <- as_tibble(as.data.frame(out)) |> 
  mutate(P0 = S0 + E0 + A0 + C0 + R0 + G0,
         P1 = S1 + E1 + A1 + C1 + R1 + G1,
         P = P0 + P1,
         M = Sm + Em + Im,
         Total = c(0, diff(CInc)),
         Adults = c(0, diff(CInc_a)),
         "Children < 5" = c(0, diff(CInc_c))) |> 
  pivot_longer(cols = -time, names_to = "variable", values_to = "value") |> 
  mutate(date = ymd("2006-01-01") + time)

# Plotting incidence

df |> 
  #filter(variable %in% c("Total", "Adults", "Children < 5"), time > 50) |> 
   filter(variable %in% c("P", "P1", "P0"), time > 50) |> 
  ggplot()+
  geom_line(aes(x = date, y = value, colour = variable)) +
  theme_health_radar() +
  scale_colour_manual_health_radar() +
  labs(
    x = "Year", 
    y = "Incidence", 
    title = "Daily malaria incidence in Zimbabwe",
    colour = "Population",
    caption = str_wrap("This plot illustrates how incidence differs between the two age groups. Among children under the age of five years, incidence decreases as they age out of this group and acquire immunity. In addition, we see that children under the age of five are a significant contribution to the burden of infection in Zimbabwe. Source: Model output.")
  ) +
  scale_x_date(
    date_breaks = "3 years",
    date_labels = "%Y"
  )  # Set x-axis breaks to multiples of 3 years

```
### Policy implications

By accounting for age specifically, policymakers can develop scenarios for vector control interventions targeted to certain age groups, such as ITN distribution campaigns in schools. Age-structured models can also allow decison makers to assess the impact of interventions such as intermittent preventive treatment in infants (IPTi) or seasonal malaria chemoprevention (SMC).

:::