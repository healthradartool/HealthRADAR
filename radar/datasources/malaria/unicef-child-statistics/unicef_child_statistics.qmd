---
title: "UNICEF DATA - Child Statistics"
description: "UNICEF DATA - Child Statistics provides detailed information on malaria's impact on children, including prevalence, treatment coverage, and mortality rates."
date: 07/04/2024 # mm-dd-yyyy
image: "images/unicef.png"

categories:
  - malaria
  - epidemiology
  - country-level
  - annual
  - children
---

::: {.page-tabs .panel-tabset}

## Overview

<h2>About the data</h2>

UNICEF DATA - Child Statistics provides data on insecticide-treated net (ITN) use, intermittent preventative treatment for pregnant women (IPTp), and key indicators related to malaria testing and treatment for children in endemic countries. These data are collected using household surveys, primarily Multiple Indicator Cluster Surveys (MICS) and Demographic and Health Surveys (DHS).

They are recorded annually, meaning that the dataset will not be appropriate for investigating seasonal trends in the indicators. For each indicator and country, values can be obtained nationally, by sex, by area (urban or rural), by mother's education level, or by wealth index quintiles (WIQ).

<h2>Accessing the data</h2>

The [UNICEF data website](https://data.unicef.org/) includes access to journal articles, publications, data visualisations, datasets, and other resources related to the data they make available.

Reaching the Child Health Coverage dataset from the [UNICEF data website](https://data.unicef.org/) homepage can be done as follows:

1.  Navigate to the \`Data by Topic' tab, and select the \`Malaria' option from the \`Child and Adolescent Health' subsection to reach [UNICEF's Malaria webpage](https://data.unicef.org/topic/child-health/malaria/#notes).
2.  Scroll down until you see the heading \`Malaria Data'. Select the download button beside the label \`Child Health Coverage'.

The dataset will be downloaded as an Excel file.

<h2>What does the data look like?</h2>

The Excel document has 19 sheets. The first, which will come up when the file is opened, contains a description of each of these sheets, as well as a thorough description of each indicator, how they are calculated, and the primary sources from which they are drawn.

![Layout of the first sheet of the Excel document.](images/malaria_xlsx_index.png)


<h2>Key points to consider</h2>

This dataset is sparse at times. It is rare that a measure recorded in a given year for a given country will be available for many other countries with which you may want to compare it. This makes it most appropriate for exploration, rather than for investigating a time series of a specific variable, or comparing a variable across specific countries in a given year. 

**Pitfalls of Annual Data:**

Using annual data for your analysis can lead to several pitfalls:

-   Seasonal variations: Annual data may not capture the seasonal patterns of malaria transmission, which can be influenced by factors such as rainfall, temperature, and vector abundance. This can lead to an over- or underestimation of the disease burden and the impact of interventions.

-   Temporal aggregation: Aggregating data annually may mask important short-term dynamics, such as outbreaks or the immediate impact of interventions.

**National Level - Ignoring Spatial Heterogeneity:**

Modelling malaria transmission at a national level can overlook important spatial heterogeneities:

-   Regional variations: Malaria transmission can vary significantly between different regions within a country due to differences in climate, vector ecology, and socio-economic factors.

-   Local hotspots: Even within regions, there can be local hotspots of malaria transmission due to factors such as proximity to breeding sites, population density, and human behavior.

-   Population movement: The movement of people between different areas can introduce or reintroduce malaria parasites, affecting transmission dynamics.

<h2>Examples of data use in literature</h2>

Around 100 UNICEF [journal articles](https://data.unicef.org/resources/resource-type/journal-articles/?f) and over 300 [publications](https://data.unicef.org/resources/resource-type/publications/?f) are made available on the UNICEF data website.


## Visualisations

<h2>How to use the dataset</h2>

This dataset includes information on Diarrhoea and Pneumonia in addition to the Malaria-related data. You can isolate data related to specific variables and countries which are pertinent to your current research. An example of how to do this, in which the Malaria-related variables and E8 countries are selected, is shown in the code chunk below. 

```{r}
#| echo: false

library(tidyverse)
library(deSolve)

source(here::here("radar/theme_health_radar.R"))
```

```{r,2}
# Read in data
data <- readxl::read_xlsx(
  "Child-Health-Coverage-Database-December-2023 .xlsx",
  sheet = "Long"
)

colnames(data) <- data[3, ]
data <- data[4:nrow(data), ]
data$Value <- as.numeric(data$Value)
data$`Latest Year` <- as.numeric(data$`Latest Year`)
data$`Level` <- factor(data$`Level`, levels = c(
  "Richest", "Fourth", "Middle", "Second",
  "Poorest", "National", "Urban", "Rural",
  "Male", "Female", "None", "Primary",
  "Sec & Higher", "15-19"
))

# Select only Malaria Indicators
mal_indicators <- c("IPTP", "ITN", "ITN2", "ITNOWN", "ITNPREG", "MLRACT", "MLRCARE", "MLRDIAG")
mal_dat <- dplyr::filter(data, data$Indicator %in% mal_indicators)

# Select only E8 countries
e8 <- c(
  "Botswana", "Eswatini", "Namibia", "South Africa",
  "Angola", "Mozambique", "Zambia", "Zimbabwe"
)
mal_dat <- dplyr::filter(mal_dat, `Countries and areas` %in% e8)
```

The first ten rows of these data can be seen in the following table:

```{r}
# Produce a table of the first ten rows of data
mal_dat |> 
  head(n = 10) |>
  dplyr::select_if(~ !all(is.na(.)))|>
  gt::gt()
```

Although data manipulation in R is often easiest using a dataframe which is in long format, tables may be easier to interpret in wide format, e.g. with each column containing data for a given year. The final ten rows of the above data, converted to wide format, are shown below. 

```{r}
# Produce a table in wide format of the last ten rows of data
mal_dat[,-c(6,8,9)] |> 
  tidyr::pivot_wider(names_from = `Latest Year`,
                     values_from = `Value`) |>
  tail(n = 10) |>
  dplyr::select_if(~ !all(is.na(.)))|>
  gt::gt()
```

<h2>How to plot these data?</h2>

```{r,3}
# Produce a line plot coloured by wealth index quintile
mal_dat|> 
  dplyr::filter(Indicator == "IPTP") |>
  dplyr::filter(`Countries and areas` == "Zambia") |>
  dplyr::filter(Stratifier == "WIQ") |>
  ggplot2::ggplot(aes(x = `Latest Year`, y = Value, group = Level)) + 
    geom_line(aes(col = Level), lwd = 2) + 
    scale_colour_manual_health_radar() + 
    theme_health_radar() + 
    xlab("Year") + 
    ylab("IPTP") + 
    labs(
      title = "Percentage of Pregnant Women who have received IPT",
       subtitle = "Data for Zimbabwe",
       caption = stringr::str_wrap("This plot displays the percentage of Zambian women between 15 and 49 years of age, who received intermittent preventative treatment (IPT) for Malaria at least three times during antenatal clinic visits for their most recent pregnancy, with data recorded between 2007 and 2019, and separated by wealth index quintile. Source: UNICEF Child Health Coverage Dataset.", width = 75),
       x = "Country",
       y = "Percentage"
    ) 
```


```{r,4}
# Produce a paired bar plot coloured by sex
mal_dat |> 
  dplyr::filter(Indicator == "ITN") |>
  dplyr::filter(`Stratifier` == "Sex") |>
  dplyr::filter(`Latest Year` == "2007") |>
  ggplot(aes(x = `Countries and areas`, y = Value, fill = Level)) +
  geom_bar(position = "dodge", stat='identity') + 
  scale_fill_manual_health_radar() + 
  theme_health_radar() + 
  xlab("Year") + 
  ylab("ITN") +
  labs(
    title = "Percentage of Children using an ITN",
    subtitle = "Data for selected African countries",
    caption = stringr::str_wrap("This plot displays the percentage of children  under 5 years of age, separated by sex, who slept under insecticide-treated mosquito nets (ITNs) the night prior to their partcipation in the survey, in Angola, Eswatini, Namibia and Zambia in the year 2007. Source: UNICEF Child Health Coverage Dataset.", width = 75),
    x = "Country",
    y = "Percentage"
  ) 
```

```{r,5}
# Produce a lollipop plot with colours indicating the year for which these data were recorded
mal_dat |> 
  dplyr::filter(Indicator == "ITNPREG") |>
  dplyr::filter(Level == "National") |>
  dplyr::filter(`Latest Year` == 2007 | `Latest Year` == 2018 | `Latest Year` == 2011 | `Latest Year` == 2015 | `Latest Year` == 2014) |>
  ggplot(aes(x = `Countries and areas`, y = Value, colour = as.factor(`Latest Year`))) + 
  geom_segment(aes(x = `Countries and areas`, xend = `Countries and areas`, y = 0, yend = Value), color = "grey") +  # Keep constant grey color for segments
  geom_point(size = 4) +
  coord_flip() +  # Adjust the aspect ratio to make the plot taller
  scale_colour_manual_health_radar() +  # Correct color scale for the discrete 'Source' variable
  theme_health_radar() +
  labs(
    title = "Percentage of Pregnant Women using an ITN",
    subtitle = "Data for selected African countries",
    caption = stringr::str_wrap("This plot displays the percentage of pregnant Zimbabwean, Zambian, Namibian, Mozambiquan, Estwatinian and Angolan women between 15 and 49 years of age, who used insecticide-treated mosquito nets (ITNs) the night prior to their participation in the survey. Records are displayed for the years 2007, 2011, 2014, 2015 and 2018. Source: UNICEF Child Health Coverage Dataset.", width = 75),
    x = "Country",
    y = "Percentage", 
    colour = "Year"
  ) 
```

## Modelling Example

<h2>How can this data be used in disease modelling?</h2>

### Preparing the data

Many malaria control interventions are targeted at vulnerable populations, specifically pregnant women and children under the age of five. Similarly, in some countries ITNs are distributed through antenatal clinics to increase access and usage of prevention methods in these groups.

For the age-structured malaria model below, we use data on ITN usage amongst children from the UNICEF dataset described above. To the rest of the population, we obtain usage data from the DHS (Demographic and Health Surveys) Program. Data detailing access to ITNs is also obtained from DHS, and is further described   [here](https://jfunction.quarto.pub/healthradar/radar/datasources/malaria/dhs-program/dhs.html). 

```{r}

# ITN usage amongst children
Zim_ITN_use_c <- mal_dat |> 
  filter(`Countries and areas` == "Zimbabwe", Indicator == "ITN", Stratifier == "National") %>% 
  mutate(Population = "Children < 5")
  
## Source ITN coverage and usage data for general population from DHS

library(rdhs)

# ML_ITNU_N_ITN: Percentage of existing insecticide treated nets used the night before the survey

Zim_ITN_use_a <- dhs_data(indicatorIds = "ML_ITNU_N_ITN",
                          countryIds = "ZW",
                          surveyYearStart = 2000) %>% 
  mutate(Population = "Adults")

ggplot() + 
  geom_point(data = Zim_ITN_use_c, aes(x = `Latest Year`, y = Value, colour = Population)) +
  geom_point(data = Zim_ITN_use_a, aes(x = `SurveyYear`, y = Value, colour = Population)) +
  geom_line(data = Zim_ITN_use_c, aes(x = `Latest Year`, y = Value, colour = Population)) +
  geom_line(data = Zim_ITN_use_a, aes(x = `SurveyYear`, y = Value, colour = Population)) +
  scale_colour_manual_health_radar() + 
  theme_health_radar() +
  labs(
    title = str_wrap("ITN usage over time in Zimbabwe amongst children and adults"),
    x = "Year",
    y = "Percent (%)",
    caption = str_wrap("In this plot we note that ITN usage in the general population decreases over time, while the ITN usage amongst children under five fluctuates. Source: UNICEF Child Health Coverage Dataset & DHS Data API.")
  )

```
There are gaps in the data due to the frequency of these national surveys: adult ITN use data ranges from 2005 to 2015, and ITN use data for children ranges from 2006 to 2019. ITN use in children has also been sampled more frequently, shown in the number of data points in the plot. To further prepare the data for inclusion into the model, we interpolate and extrapolate all data points between 2006 and 2019.

```{r}
# Fill in data gaps between 2006 and 2019 (not shown in plot below)
## ITN use in children
ITNuse_children <- Zim_ITN_use_c %>% 
  select(`Latest Year`, Value, Population) %>% 
  complete(`Latest Year` = seq(min(`Latest Year`), 2019, by = 1)) %>%
  mutate(Value = approx(`Latest Year`, Value, `Latest Year`, rule = 2)$y) %>%
  fill(Population, .direction = "downup") %>% 
  mutate(Value = Value/100) # Convert into percentage

## ITN use in adults
ITNuse_adult <- Zim_ITN_use_a %>% 
  complete(SurveyYear = seq(min(SurveyYear), 2019, by = 1)) %>% 
  mutate(Value = approx(SurveyYear, Value, SurveyYear, rule = 2)$y) %>% # rule 2 allows for extrapolation to 2019
  fill(Population, .direction = "downup") %>% 
  mutate(Value = Value/100) %>% 
  filter(SurveyYear > 2005) # start at 2006 to have same range as UNICEF data

ggplot() + 
  geom_point(data = ITNuse_children, aes(x = `Latest Year`, y = Value, colour = Population)) +
  geom_point(data = ITNuse_adult, aes(x = `SurveyYear`, y = Value, colour = Population)) +
  geom_line(data = ITNuse_children, aes(x = `Latest Year`, y = Value, colour = Population)) +
  geom_line(data = ITNuse_adult, aes(x = `SurveyYear`, y = Value, colour = Population)) +
  scale_colour_manual_health_radar() + 
  theme_health_radar() +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = str_wrap("Extrapolated and interpolated values for ITN usage over time in Zimbabwe"),
    x = "Year",
    y = "Percentage",
    caption = str_wrap("The data trend indicates that ITN usage in the general population (considered here to be over the age of five years old) decreases over time. Amongst children under five ITN usage fluctuates, but is generally lower than usage in adults. Source: UNICEF Child Health Coverage Dataset & DHS Data API.")
  )

## ITN access data 
# ML_NETP_H_IT2: Percentage of households with at least one insecticide-treated mosquito net (ITN) for every two persons who stayed in the household the previous night

access_data <- dhs_data(
  indicatorIds = "ML_NETP_H_IT2",
  countryIds = "ZW",
  surveyYearStart = 2000
)

# Survey Years were 2005, 2010 and 2015
# Use complete to fill in years between 2005 and 2019
complete_access_data <- access_data %>% 
  select(SurveyYear, Value) %>% 
  complete(SurveyYear = seq(min(SurveyYear), 2019, by = 1)) %>%  # Fill in missing years
  mutate(Value = approx(SurveyYear, Value, SurveyYear, rule = 2)$y) %>% 
  mutate(Value = Value/100) %>% 
  filter(SurveyYear > 2005) # start at 2006 to have same range as UNICEF data

```

We may consider the proportion of the population effectively covered by ITNs to be those with access to at least one ITN and actively using the net. In addition, the effectiveness of the nets at preventing infectious bites decreases over time as chemical efficacy drops and nets are damaged through wear and tear and considered lost. This loss is also called attrition, $attr$. The median survival time of long lasting insecticidal nets (LLINs) is considered to be three years, represented by $eta$ in the model. For a more detailed description of the incorporation of ITNs, see the [DHS](https://jfunction.quarto.pub/healthradar/radar/datasources/malaria/dhs-program/dhs.html) page. For this example, we use UNICEF-sourced data to inform an age-structured model, depicting two populations: all people over the age of five, and children under five years old.

### Model assumptions

For the purposes of this model we make the following assumptions:

-   Children under the age of five are 20% more susceptible to mosquito transmission $b$ than children over the age of five and adults
-   Mortality rates $mu_h$ ($\mu_h$) in both age groups are the same
-   The duration of partial immunity $rho$ ($\rho$) in adults is longer in adults because of previous malaria infections
-   Net usage differs in vulnerable populations, specifically children under the age of five

Consequently, the force of infection $lambda$ ($\lambda$) in children under the age of five years, i.e. the rate at which they are exposed to an infectious vector, will be higher than that adults. This is due to their increased susceptibility to infection, and shorter span of partial immunity.

```{r}
library(deSolve)
# Time points for the simulation
Y = 14 # Years of simulation from 2006 to 2019
times <- seq(0, 365*Y, by = 1)

# Input of time-dependent variables of ITN access and use

itn_access_input <- approx(complete_access_data$SurveyYear, complete_access_data$Value, n = length(times), method = "constant", rule = 2)$y
itnfunc <- approxfun(itn_access_input, method = "linear", rule = 2)

ITNuse_children_input <- approx(ITNuse_children$`Latest Year`, ITNuse_children$Value, n = length(times), method = "constant", rule = 2)$y
itnuse_childrenfunc <- approxfun(ITNuse_children_input, method = "linear", rule = 2)

ITNuse_adult_input <- approx(ITNuse_adult$SurveyYear, ITNuse_adult$Value, n = length(times), method = "constant", rule = 2)$y
itnuse_adultfunc <- approxfun(ITNuse_adult_input, method = "linear", rule = 2)

## SEACR-SEI model
seacr <- function(times, start, parameters, itnfunc, itnuse_childrenfunc, itnuse_adultfunc) { 
  with(as.list(c(start, parameters)), {
    P0 = S0 + E0 + A0 + C0 + R0  
    P1 = S1 + E1 + A1 + C1 + R1 
    P = P0 + P1
    M = Sm + Em + Im
    m = M / P
    
    seas =  1+amp*cos(2*pi*(times/365 - phi))
    
    itn_access <- itnfunc(times)
    eta <- -log(1-(1-attr))/(3*365) #loss due to attrition over 3 years
    itn_a = min(ITN,1)*itnuse_adultfunc(times)*itn_eff # MIN because the proportion of population covered by ITN should never be more than 1
    itn_c = min(ITN,1)*itnuse_childrenfunc(times)*itn_eff 
    
    # Force of infection
    Infectious = C0 + C1 + zeta*(A1+A0) #infectious reservoir
    lambda_a = ((a^2*b_a*c*m*Infectious/P)/(a*c*Infectious/P+mu_m)*(gamma_m/(gamma_m+mu_m)))*seas*(1-itn_a)
    lambda_c = ((a^2*b_c*c*m*Infectious/P)/(a*c*Infectious/P+mu_m)*(gamma_m/(gamma_m+mu_m)))*seas*(1-itn_c)
    
    # Differential equations/rate of change
    # Mosquitoes assumed to be at equilibrium
    dSm = 0
    dEm = 0
    dIm = 0
    
    # Children 
    dS0 = mu*P - lambda_c*S0 + rho_c*R0 - mu_h*S0 - kappa_c*S0
    dE0 = lambda_c*S0 - (gamma_h + mu_h + kappa_c)*E0
    dA0 = pa*gamma_h*E0 - (delta + mu_h + kappa_c)*A0
    dC0 = (1-pa)*gamma_h*E0 - (r + mu_h + kappa_c)*C0
    dR0 = delta*A0 + r*C0 - (rho_c + mu_h + kappa_c)*R0
    
    # Adult 
    dS1 = kappa_c*S0 - lambda_a*S1 + rho_a*R1 - mu_h*S1
    dE1 = kappa_c*E0 + lambda_a*S1 - (gamma_h + mu_h)*E1
    dA1 = kappa_c*A0 + pa*gamma_h*E1 - (delta + mu_h)*A1
    dC1 = kappa_c*C0 + (1-pa)*gamma_h*E1 - (r + mu_h)*C1
    dR1 = kappa_c*R0 + delta*A1 + r*C1 - (rho_a + mu_h)*R1
    
    dCInc = lambda_c*S0 + lambda_a*S1 # total cumulative incidence
    dITN = itn_access - (eta + itn_death)*ITN 
    
    dCInc_c = lambda_c*S0 # cumulative incidence in children
    dCInc_a = lambda_a*S1 # cumulative incidence in adults
    
    # Output
    list(c(dSm, dEm, dIm, dS0, dE0, dA0, dC0, dR0, dS1, dE1, dA1, dC1, dR1, dCInc, dITN, dCInc_c, dCInc_a))
  })
}


# Initial values for compartments
initial_state <- c(Sm = 10000000, # susceptible mosquitoes
                   Em = 10000000, # exposed and infected mosquitoes
                   Im = 10000000, # infectious mosquitoes
                   S0 = 3000000, # susceptible children
                   E0 = 1500000, # exposed and infected children
                   A0 = 800000, # asymptomatic and infectious children
                   C0 = 500000, # clinical and symptomatic children
                   R0 = 200000, # recovered and semi-immune children
                   S1 = 5000000, # susceptible adults
                   E1 = 2500000, # exposed and infected adults
                   A1 = 1000000, # asymptomatic and infectious adults
                   C1 = 700000, # clinical and symptomatic adults
                   R1 = 300000, # recovered and semi-immune adults
                   CInc = 0, # cumulative incidence
                   ITN = 0.5, # proportion of the population with potential to be protected by nets CURRENTLY IN CIRCULATION
                   CInc_c = 0, # cumulative incidence in children
                   CInc_a = 0 # cumulative incidence in adults
)
# Country-specific parameters should be obtained from literature review and expert knowledge
parameters <- c(a = 0.3, # human biting rate
                b_a = 0.4, # probability of transmission from mosquito to adult human
                b_c = 0.48, # probability of transmission from mosquito to child human under the age of five (b_a*1.2)
                c = 0.4, # probability of transmission from human to mosquito
                r = 1/7, # rate of loss of infectiousness after treatment
                rho_c = 1/50, # rate of loss of immunity after recovery in children
                rho_a = 1/160, # rate of loss of immunity after recovery in adults
                delta = 1/200, # natural recovery rate
                zeta = 0.4, # relative infectiousness of of asymptomatic infections
                pa = 0.1, # probability of asymptomatic infection
                mu_m = 1/10, # birth and death rate of mosquitoes
                mu_h = 1/(50*365), # death rate of humans
                mu = (32/1000)/365, # crude birth rate per 1000 humans
                gamma_m = 1/10, # extrinsic incubation rate of parasite in mosquitoes
                gamma_h = 1/10, # extrinsic incubation rate of parasite in humans
                amp = 0.6, #amplitude of seasonality
                phi = 200, #phase angle; start of season
                kappa_c = 1/(30.44*59), # aging rate from the first age group (30.44 days * 59 months)
                attr = 0.55, # nets remaining after 3 years in circulation
                itn_eff = 0.45, # effectiveness of ITN at preventing ongoing transmission
                itn_death = 1/(3*365) # median net survival is three years

)

# Run the model

out <- ode(
  y = initial_state, 
  times = times, 
  func = seacr, 
  parms = parameters,
  itnfunc = itnfunc,
  itnuse_childrenfunc = itnuse_childrenfunc,
  itnuse_adultfunc = itnuse_adultfunc
)


# Post-processing model output into a dataframe

df <- as_tibble(as.data.frame(out)) |> 
  mutate(P0 = S0 + E0 + A0 + C0 + R0,
         P1 = S1 + E1 + A1 + C1 + R1,
         P = P0 + P1,
         M = Sm + Em + Im,
         Total = c(0, diff(CInc)),
         Adults = c(0, diff(CInc_a)),
         "Children < 5" = c(0, diff(CInc_c))) |> 
  pivot_longer(cols = -time, names_to = "variable", values_to = "value") |> 
  mutate(date = ymd("2006-01-01") + time)

# Plotting incidence

df |> 
  filter(variable %in% c("Total", "Adults", "Children < 5"), time > 50) |> 
  ggplot()+
  geom_line(aes(x = date, y = value, colour = variable)) +
  theme_health_radar() +
  scale_colour_manual_health_radar() +
  labs(
    x = "Year", 
    y = "Incidence", 
    title = "Daily malaria incidence in Zimbabwe",
    colour = "Population",
    caption = str_wrap("This plot illustrates how incidence differs between the two age groups. In the age group of children under the age of five years incidence decreases, which is consistent with previous data shown depicting lower ITN usage in this group. In addition, children under the age of five are a significant contribution to the burden of infection in Zimbabwe. Source: Model output.")
  ) +
  theme_health_radar() +
  scale_x_date(
    date_breaks = "3 years",
    date_labels = "%Y"
  )  # Set x-axis breaks to multiples of 3 years

```


:::