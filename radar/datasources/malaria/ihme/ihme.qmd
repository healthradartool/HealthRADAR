---
title: "Institute for Health Metrics and Evaluation"
description: "The Institute for Health Metrics and Evaluation (IHME) works with collaborators around the world to develop timely, relevant, and scientifically valid evidence that illuminates the state of health everywhere."
date: 10-23-2024 # mm-dd-yyyy
image: "images/ihme.jpg"

categories:
  - malaria
  - epidemiology
  - interventions
  - country-level
  - annual
---

::: {.page-tabs .panel-tabset}

## Overview

<h2>About the data</h2>

The [**Global Burden of Disease (GBD)**](http://www.healthdata.org/gbd/about) study, conducted by the Institute for Health Metrics and Evaluation (IHME), evaluates mortality and disability caused by 371 diseases and injuries, along with 88 risk factors across the globe. IHME meticulously collects and analyzes the data, offering insights into trends over time, the effectiveness of interventions, and disparities in the impact of malaria among different populations. The IHME provides extensive malaria data that includes prevalence, incidence, mortality rates, intervention coverage, and the overall burden of disease in 204 countries and territories, with subnational estimates for 21 regions. This comprehensive dataset is a valuable resource for policymakers, researchers, and public health professionals in developing strategies to reduce the global malaria burden and monitor progress toward elimination goals.

<h2>Accessing the data</h2>

The **GBD Results Tool** enables you to download estimates from the study, along with relevant materials such as survey instruments, protocols, and summary information, are accessible on the [**IHME Data Page**](https://ghdx.healthdata.org/ihme_data) through the Global Health Data Exchange (GHDx). You can search for datasets directly or use the [**GDB Results Tool**](https://vizhub.healthdata.org/gbd-results) for more detailed queries. IHME also offers API access to interact with large datasets programmatically.

Search terms such as `"IHME malaria deaths estimates"`, `"malaria prevalence"`, `"malaria incidence"`, or `"bednet usage"` can be used to find datasets compiled by IHME related to malaria on the GHDx homepage.

Alternatively, you can navigate to the Data Tools tab on the homepage. However, you will need to **create an account or sign in** to access and download data. If you do not have an account, click on **sign in** at the top of the Results tab. If you already have an account, click sign in and enter your credentials, then select **GBD results tool** under IHME Data Visualization Tools. In the results tool interface, select the choose the disease metrics and apply filters to narrow the search by `location (country/region)`, `year`, `age group`, and `sex`.

![IHME GBD Results Visualization Tool Page.](images/ihme_gbd_estimates_viz.png "IHME GBD Results Tool")

You can also visualize data as graphs or tables before downloading. You can right-click on the title of files within the GHDx and download them. Datasets can be downloaded as `.csv` and `.xls` files from the GHDx site.

<h2>What does the data look like?</h2>

The data can be downloaded from the [**GHDx IHME ITN Data Page**](https://ghdx.healthdata.org/record/ihme-data/sub-saharan-africa-insecticide-treated-bed-nets-1999-2008) as a `.xls` file. This dataset provides estimates of bed net ownership, ownership among populations at risk, bed net use in children under five in at-risk populations, and trends in the scale-up of LLIN in 44 African countries during the 1999 to 2008 period.

![IHME estimates of insecticide treated bednets distributed.](images/IHME_itns_1999_to_2008.png "IHME ITN dataset")

Datasets dowloaded as `.csv` files from the [**GDB Results Tool**](https://vizhub.healthdata.org/gbd-results) have a standard format which contains mortality, prevalence and incidence in number, percent and rate by location, sex, age, cause of injury, annual value as well as the upper and lower bounds.

![IHME estimates of malaria related deaths, prevalence and incidence.](images/ihme_gbd_malaria_metrics.png "IHME malaria metrics dataset")

<h2>Key points to consider</h2>

IHME (Institute for Health Metrics and Evaluation) provides detailed data on health metrics, including estimates of disease burden such as incidence, mortality, and risk factors for malaria, which can inform transmission models. When integrating IHME data estimates into malaria transmission models, several key aspects should be considered regarding data collection, storage, and its usage to ensure accurate and effective modeling. 

- IHME uses statistical models and expert review to produce comprehensive Global Burden of Disease (GBD) estimates of malaria burden by country, age, and sex.

- Data is updated annually or periodically depending on the source (e.g., monthly surveillance data or annual surveys).

- These data might not always have the same resolution as the model. For instance, while a model may require fine-grained data at the village level or daily intervals, IHME may provide data aggregated at the national level or annually.

- IHME estimates often come with uncertainty intervals due to limitations in the data sources. This uncertainty should be accounted for in model simulations, especially for stochastic models or sensitivity analyses.

## Visualisations

<h2>How to use this data?</h2>

```{r, echo = FALSE}

source(here::here("radar/theme_health_radar.R"))   # source in the theme functions
```

These datasets can be explored to gain insights into the ownership of ITNs, distribution of LLINs, and assess the impact of malaria in Elimination 8 (E8) countries during the 2000 to 2008 period.

Inspect the data beforehand to understand how it is structured and identify indicators that are relevant to our analysis, we can display our data in a table as follows:

```{r, echo = TRUE}
library(readxl)
library(tidyverse)

# Load insecticide treated nets data
ihme_nets <- read_excel(path = "datasets/IHME_INSECTICIDE_TREATED_BEDNETS_SUB_SAHARAN_AFRICA_1999_2008.xls")

# Pull the names of countries
ihme_nets |>  
  pull(Country) |>  
  unique()
```

The E8 countries are Angola, Botswana, Eswatini, Mozambique, Namibia, South Africa, Zambia and Zimbabwe. To filter the data for these countries, you can use the following code to display our data in a table as follows:

```{r, echo = TRUE}
library(gt)

# define the E8 countries
e8_countries <- c("Angola", "Botswana","Eswatini", "Mozambique", "Namibia", "South Africa", "Zambia",  "Zimbabwe")

ihme_nets |>  
  mutate(Country = ifelse(Country == "Swaziland", "Eswatini", Country)) |>  
  filter(Country %in% e8_countries) |>  
  head() |>  
  gt()
```


**Deaths, prevalence and incidence estimates**

This data set contains number/percents/rates of malaria deaths, prevalence and incidence in the following countries:

```{r, echo = TRUE}
observed_cases <- read_csv("datasets/IHME-GBD_2021_DATA-05f6b66f-1.csv", show_col_types = FALSE) 

observed_cases |>  
  pull(location_name) |>  
  unique()
```

We can look at the data to identify indicators to use for analysis:

```{r, echo = TRUE}
library(gt)

observed_cases |>  
  filter(location_name == "Republic of South Africa") |> 
  head() |>  
  gt()
```

<h2>How to plot this data?</h2>

We display the % ITN ownership in E8 countries with lower and upper bounds.

```{r, echo = TRUE}
ihme_nets |>  
  mutate(Country = ifelse(Country == "Swaziland", "Eswatini", Country)) |>  
  filter(Country %in% e8_countries) |> 
  ggplot(aes(x = Year, y = `% ITN Ownership`, color = Country)) +
  geom_line(linewidth = 1) +
  geom_ribbon(aes(ymin = `% ITN Ownership Lower Bound`, ymax = `% ITN Ownership Upper Bound`, fill = Country), alpha = 0.2) +
  scale_colour_manual_health_radar() +  # Apply manual color scale for 'color' aesthetic (lines)
  scale_fill_manual_health_radar() +    # Apply manual color scale for 'fill' aesthetic (ribbon fill)
  theme_health_radar() +
  labs(
    title = "Estimated ITN Ownership",
    subtitle = "With confidence bands",
    x = "Year",
    y = "ITN Ownership (%)",
    color = "Country",
    fill = "Country",  # Added 'fill' label for the ribbon shading
    caption = str_wrap("The plot illustrates the estimated ITN ownership in E8 countries from 1999 to 2008. Lines indicate the ownership estimates, while shaded areas represent the confidence bands. The uncertainty in ITN ownership remains fairly consistent across all countries. South Africa and Eswatini had the lowest levels of ITN ownership, but after 2004, there is a noticeable rise in ownership in the other countries, with Zambia showing the higest increase.", width = 85)
  )
```

Trend in % ITN Ownership among at-risk populations.

```{r, echo = TRUE}
ihme_nets |>  
  mutate(Country = ifelse(Country == "Swaziland", "Eswatini", Country)) |>  
  filter(Country %in% e8_countries) |> 
  ggplot(aes(x = Year, y = `% ITN Ownership Pop. At Risk`, color = Country)) +
  geom_line(linewidth = 1) +
  scale_colour_manual_health_radar() + 
  theme_health_radar() +
  labs(
    title = "Estimated ITN Ownership in populations at-risk",
    x = "Year",
    y = "ITN Ownership in Pop. At Risk (%)",
    color = "Country",
    caption = str_wrap("The plot depicts estimated ITN ownership among at-risk populations from 1998 to 2008 in E8 countries. The rise in ITN ownership in all countries, with Zambia, Botswana and Zimbabwe showing the highest increases followed by Namibia, Mozambique and Angola. South Africa and Eswatinin remain lower than 20 % ownership in populations at risk.", width = 85)
  )
```

ITN use among U5s in at-risk populations vs ITN Use in U5s.

```{r, echo = TRUE}
ihme_nets |>  
  mutate(Country = ifelse(Country == "Swaziland", "Eswatini", Country)) |>  
  filter(Country %in% e8_countries) |> 
  ggplot(aes(x = `% ITN Use U5`, y = `% ITN Use U5 Pop. At Risk`, color = Country)) +
  geom_line(linewidth = 1) +
  geom_point(size = 2) +
  scale_colour_manual_health_radar() + 
  theme_health_radar() +
  labs(
    x = "ITN Use U5 (%)",
    y = "ITN Use U5 Pop. At Risk (%)",
    color = "Country",
    fill = "Country",  # Added 'fill' label for the ribbon shading
    caption = str_wrap("The plot depicts estimated ITN use among children under five years old in at-risk populations with respect to ITN usage in children under five in E8 countries. Zambia, Mozambique and Angola show an equal rise in ITN use among children under five in populations at risk as ITN usage increases in children under five years old. In contrast, The other countries show higher usage among children under five years old in at risk populations despite lower ITN usage in children under five.", width = 85)
  )
```

Scale-up of LLIN distribution.

```{r, echo = TRUE}
ihme_nets |>  
  mutate(Country = ifelse(Country == "Swaziland", "Eswatini", Country),
         Category = case_when(Country == "Zambia" ~ "1",
                         Country %in% c("Angola", "Mozambique", "Namibia", "Zimbabwe") ~ "2",
                         Country %in% c("Botswana", "Eswatini", "South Africa") ~ "3"
                         ) |>  as.factor()
         ) |>  
  filter(Country %in% e8_countries) |> 
  group_by(Category) |>  
  ggplot() +
  geom_bar(aes(x = Year, y = `LLINs Distributed Per Capita`, fill = Category), stat = "identity", position = "dodge") +
  facet_wrap(~Country, scales = "fixed") +
  scale_fill_manual_health_radar() +   
  theme_health_radar() +
  labs(
    x = "Year",
    y = "LLINs Distributed Per Capita",
    fill = "Category",
    caption = str_wrap("The plot shows estimate of annual % of LLINs distributed in E8 countries during the 1998 to 2008 period. Despite the low levels of distribution, South Africa has distributed LLINs relatively consistently through the years. There is a significant scale-up in LLIN distribution in all other countries, with Mozambique showing a consistent rise in distribution. Zambia has the highest distribution of LLINs per capita followed by Mozambique, Namibia, Zimbabwe and Angola, whereas Botswana, Eswatini and South Africa have the least LLINs distributed.", width = 85)
  )
```

Here we show the trends in malaria deaths, percent prevalence and incidence rates during the 2000 to 2021 period.

```{r}

observed_cases |>  
  as.data.frame() |>  
  filter(measure_name == "Deaths", metric_name == "Number") |>  
  group_by(location_name) |>  
  ggplot() +
  geom_bar(aes(x = year, y = val, fill = location_name), stat = "identity", position = "stack") +
  scale_fill_manual_health_radar() +   
  theme_health_radar() +
  labs(
    x = "Year",
    y = "Deaths",
    fill = "Country",
    caption = str_wrap("This bar plot shows Institute of Health Metrics and Evaluation (IHME) estimates of the total number of deaths caused by malaria in Elimination 8 (E8) countries during the 2000 to 2021 period. The largest number of deaths is recorded in the Republic of Mozambique and Angola, followed by the Republic of Zimbabwe and Zambia whereas the remaining countries show substantially less deaths recorded during this period. Source: Institute for Health Metrics and Evaluation (IHME). Global Burden of Disease Study 2021 (GBD 2021) Results. Seattle, WA: IHME, University of Washington, 2024. Available from: https://vizhub.healthdata.org/gbd-results/", width = 85)
  )
```

Similarly we show the percent prevalence of malaria in these countries in the following plot:

```{r, echo = TRUE}
observed_cases |>  
  as.data.frame() |>  
  filter(measure_name == "Prevalence", metric_name == "Percent") |>  
  ggplot(aes(x = year, y = val, color = location_name)) +
  geom_line(linewidth = 1) +
  scale_colour_manual_health_radar() +  
  scale_fill_manual_health_radar() +
  theme_health_radar() +
  labs(
    title = "Estimated malaria prevalence",
    x = "Year",
    y = "Percent",
    color = "Location",
    fill = "Location",  # Added 'fill' label for the ribbon shading
    caption = str_wrap("The plot shows the trends in estimated percentage malaria prevalence across the malaria Elimination 8 (E8) countries during the 2000 to 2021 period. Malaria prevalence in these countries have remained below 40%, with some countries such as the Republic of Mozambique and Zambia, that show a decline in prevalence. Although there was a decrease observed in the Republic Angola in 2005, prevalence remained relatively constant for a period of 5 years from 2010 to 2015 which then saw a rise in prevalence from 10% to 20%. Source: Institute for Health Metrics and Evaluation (IHME). Global Burden of Disease Study 2021 (GBD 2021) Results. Seattle, WA: IHME, University of Washington, 2024. Available from: https://vizhub.healthdata.org/gbd-results/", width = 85)
  )
```

Finally, the incidence rates are shown in as follows:

```{r, echo = TRUE}
observed_cases |>  
  as.data.frame() |>  
  filter(measure_name == "Incidence", metric_name == "Rate") |>  
  ggplot(aes(x = year, y = val, color = location_name)) +
  geom_line(linewidth = 1) +
  geom_ribbon(aes(ymin = lower, ymax = upper, fill = location_name), alpha = 0.2) +
  scale_colour_manual_health_radar() +  
  scale_fill_manual_health_radar() +
  theme_health_radar() +
  labs(
    title = "Estimated malaria incidence rate",
    subtitle = "With confidence bands",
    x = "Year",
    y = "Rate (cases per 1000 per year)",
    color = "Location",
    fill = "Location",  
    caption = str_wrap("The plot illustrates the estimated malaria incidence rate from 2000 to 2021 in Elimination 8 (E8) countries. The lines represent incidence rate and the shaded areas show the uncertainty intervals. The Republic of Mozambique experienced malaria incidence around 40 to 60 thousand cases per 1000 per year in 2000 and has decreased to 30 to 40 thousand cases per 1000 per thousand. The Republic of Zimbabwe experiences seasonal malaria incidence with cases fluctuating along the years during the 21 year period. Source: Institute for Health Metrics and Evaluation (IHME). Global Burden of Disease Study 2021 (GBD 2021) Results. Seattle, WA: IHME, University of Washington, 2024. Available from: https://vizhub.healthdata.org/gbd-results/", width = 85)
  )
```

## Modelling Example

<h2>How can this data be used in disease modelling?</h2>

The Global Burden of Disease (GBD) data on historical trends in on various disease metrics can serve to validate the accuracy of predictions made by transmission models. Malaria models frequently require calibration to align with IHME-derived estimates, such as adjusting transmission rates based on observed incidence or prevalence.

### Preparing the data 

The Global Burden of Disease study has produced estimates of prevalence for malaria worldwide. Prevalence is defined as the total number of cases of a given cause in a specified population at a designated time. It is differentiated from incidence, which refers to the number of new cases in the population at a given time. Observations from *Plasmodium falciparum* parasite rate (*Pf*PR) surveys and national routine surveillance systems of confirmed and unconfirmed diagnoses are augumented into a model of disease burden. More information on this methodology is provided [here](https://www.healthdata.org/gbd/methods-appendices-2021/malaria).

```{r}

# Load data from GBD
observed_df <- read_csv("datasets/IHME-GBD_2021_DATA-05f6b66f-1.csv", show_col_types = FALSE) |>  
  as.data.frame() |>  
  filter(measure_name == "Prevalence", metric_name == "Number", location_name == "Republic of South Africa") |>  
  rename(value = val)

observed_df |>  
ggplot() +
  geom_point(aes(x = year, y = value, colour = measure_name)) +
  geom_line(aes(x = year, y = value, colour = measure_name)) +
  scale_colour_manual_health_radar() +
  theme_health_radar() +
  labs(title = "Observed malaria point prevalence for South Africa",
    x = "Year",
    y = "Number of Cases",
    caption = str_wrap("Source: Institute for Health Metrics and Evaluation IHME | Global Burden of Disease Study (GBD) 2021.")) +
  guides(colour = "none")

```

### Modeling prevalence

A good use of prevalence data is to calibrate transmission models. This is particularly useful if incidence data is limited, and in diseases with a significant asymptomatic proportion of the population, such as malaria. Fitting the model to both incidence and prevalence data provides a more complete picture of disease dynamics.

Using prevalence data is not without challenges. Health system challenges preventing individuals from accessing diagnosis and treatment, may result in under-reporting. In addition, because point prevalence is obtained from cross-sectional surveys, we may fail to capture dynamic trends in transmission and malaria immunity.

Malaria models set in endemic countries also assume that humans can be exposed to and infected by an infectious mosquito while recovering from an initial infection (secondary infection). It may be difficult to estimate the true proportion of the population that has recovered from an initial infection already, and is now susceptible to a secondary infection.

**Model calibration**

To calibrate the model, firstly, build a transmission model that reflects the underlying health system dynamics in the country,  coverage levels for any control interventions deployed, as well as relevant mosquito, parasite and human behaviours. We then select key parameters to fine-tune, causing the model output to better mimic the observed data.

We minimise the difference between the model output and observed data using sum of least squares or maximum likelihood estimation. An example of this function is shown in the code snippet below, and a simulated plot thereafter.

```{r, eval=FALSE}

#|eval: false
#|echo: true
#|warning: false

# Objective or cost function
objective_function <- function(initial_parameters, observed_df) {
  
  # Parameters to fine tune
  a <- initial_parameters[1] # human biting rate
  pa <- initial_parameters[2] # probability of asymptomatic infection
  irs_eff <- initial_parameters[3] # effectiveness of IRS at reducing transmission
  delta <- initial_parameters[4] # natural recovery rate
  r <- initial_parameters[5] # rate of loss of infectiousness
  
  # Run the ODE model
  output_df <- ode(y = initial_state, 
           times = times, 
           func = seacr, 
           parms = initial_parameters,
           irs_cov = irs_cov)
    
  # Calculate the values for prevalence
  prev_df <- output_df |>  
  as.data.frame() |>  
  mutate(Prv = c(0, diff(CPrv))) |> 
  pivot_longer(!time, names_to = "state", values_to = "value") |>  
  mutate(year = 1995 + ceiling(time/365)) |>  
  filter(state %in% "Prv") |>  
  group_by(year) |> 
  slice_tail(n = 1) |>  
  filter(year >= 2000) # adjust timeframe to match data
   
  # Actual GBD data
  observed_prev <- filter(observed_df, measure_name == "Prevalence")$value
  
  # Model projections
  predicted_prev <- prev_df$value
  
  # Calculate distance using sum of least squares or Poisson log- likelihood
  error <- (observed_prev - predicted_prev)^2
  #error <- dpois(round(observed_prev, 0), predicted_prev, log = TRUE)
  
  total <- sum(error)
 
  return(-total)
}

# Run optimization to mimimise total

optim_result <- optim(par = initial_parameters, 
                      fn = objective_function, 
                      observed_df = observed_df, 
                      method = "L-BFGS-B",
                      lower = c(a = 0.1, rho = 1/500, pa = 0.01, delta = 1/280, irs_eff = 0.1, r = 1/21),
                      upper = c(a = 0.9, rho = 1/40, pa = 0.9, delta = 1/90, irs_eff = 0.9, r = 1/3)
                     )

# Best-fit parameters from calibration
cal_parameters <- optim_result$par

# Run model with new calibrated parameters 
calibrated_output <- ode(y = initial_state, 
           times = times, 
           func = seacr, 
           parms = cal_parameters,
           irs_cov = irs_cov)

# Plot prevalence of new model fit with ggplot

```


```{r}

set.seed(123)

# Simulated values
predicted_prev <- data.frame(
  year = 2000:2021,
  value = observed_df$value + rnorm(length(observed_df$value), mean = 3000, sd = 2000)) |>  
  mutate(
    key = "Initial model output") |> 
  bind_rows(
      data.frame(
  year = 2000:2021,
  value = observed_df$value + rnorm(length(observed_df$value), mean = 1000, sd = 400)) |>  
  mutate(
    std_error = 700, # for example
    lower = value - (1.96 * std_error),
    upper = value + (1.96 * std_error),
    key = "Calibrated Projected prevalence")
    )

merged_df <- bind_rows(
  predicted_prev,
  mutate(observed_df, key = "GBD estimates")
  ) 

ggplot() +
   geom_line(data = filter(merged_df, key == "GBD estimates"), aes(x = year, y = value, colour = key)) +
   geom_pointrange(data = filter(merged_df, key == "GBD estimates"), aes(x = year, y = value, ymin = lower, ymax = upper, colour = key)) + 
  geom_line(data = filter(merged_df, key == "Initial model output"), aes(x = year, y = value, colour = key)) +
geom_line(data = filter(merged_df, key == "Calibrated Projected prevalence"), aes(x = year, y = value, colour = key)) +
  geom_ribbon(data = filter(merged_df, key == "Calibrated Projected prevalence"), aes(x = year, y = value, ymin = lower, ymax = upper), fill = "grey", alpha = 0.4) +
  scale_colour_manual_health_radar() +
  theme_health_radar() +
  labs(title = "Malaria point prevalence for South Africa from 2000 to 2021",
       subtitle = "Simulation of projected prevalance from the transmission model alongside prevalence data",
    x = "Year",
    y = "Number of Cases",
    Colour = "Variable",
    caption = str_wrap("The calibrated model simulations align more closely with the observed prevalence than the initial projections. These results are compared against prevalence data from the Global Burden of Disease (GBD) 2021 study. The gray ribbon represents the uncertainty in the model estimates, and its overlap with the data's confidence intervals suggests a strong fit.")
  )
```

Calibrating disease models to real-world data can be challenging. Methods like Approximate Bayesian Computation can be better when considering large datasets or complex models, but may be computationally expensive. You can find some examples of calibration in the literature below:

-   Awine, T., & Silal, S. P. Assessing the effectiveness of malaria interventions at the regional level in Ghana using a mathematical modelling application. PLOS global public health, 2(12), e0000474 (2022). <https://doi.org/10.1371/journal.pgph.0000474>


:::